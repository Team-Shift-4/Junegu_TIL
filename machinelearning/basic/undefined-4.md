# ë¡œì§€ìŠ¤í‹± íšŒê·€

## ë¡œì§€ìŠ¤í‹± íšŒê¸°

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

7ë§ˆë¦¬ì˜ ìƒì„  ëœë¤í•˜ê²Œ ë‹´ê¸´ ëŸ­í‚¤ ë°± ì´ë²¤íŠ¸ ì‹¤ì‹œ(ëŸ­í‚¤ ë°±ì— í¬í•¨ëœ ìƒì„ ì˜ í™•ë¥  í‘œì‹œ)

### ëŸ­í‚¤ë°±ì„ ë§Œë“¤ì–´ë³´ì!

ë¨¼ì €, íŒë‹¤ìŠ¤ë¥¼ í™œìš©í•´ ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ì.

```python
import pandas as pd

fish = pd.read_csv('<https://bit.ly/fish_csv_data>')
fish.head()
```

<figure><img src="../../.gitbook/assets/5-1.png" alt=""><figcaption></figcaption></figure>

ì–´ë–¤ ì¢…ë¥˜ì— ìƒì„ ì´ ìˆì„ê¹Œ? **íŒë‹¤ìŠ¤ì˜ unique ë©”ì„œë“œ**ë¥¼ ì‚¬ìš©í•˜ë©´ ë°”ë¡œ ì•Œ ìˆ˜ ìˆë‹¤.

```python
print(pd.unique(fish['Species']))

# ê²°ê³¼ 
['Bream' 'Roach' 'Whitefish' 'Parkki' 'Perch' 'Pike' 'Smelt']
```

ì´ ì±…ì—ì„œëŠ” Species ì—´ì„ íƒ€ê²Ÿìœ¼ë¡œ ë§Œë“¤ê³  ë‚˜ë¨¸ì§€ 5ê°œ ì—´ì€ ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©í•œë‹¤. ì›í•˜ëŠ” ì—´ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ë‚˜ì—´í•˜ê³  ë‚˜ë¨¸ì§€ 5ê°œì˜ ì—´ì„ ì„ íƒ í•´ë³´ì.

```python
fish_input = fish[['Weight', 'Length', 'Diagonal','Height','Width']].to_numpy()

print(fish_input.shape) 
print(fish_input[:5])

# ê²°ê³¼ 
(159, 5)
[[242.      25.4     30.      11.52     4.02  ]
 [290.      26.3     31.2     12.48     4.3056]
 [340.      26.5     31.1     12.3778   4.6961]
 [363.      29.      33.5     12.73     4.4555]
 [430.      29.      34.      12.444    5.134 ]]
```

ì´ì œ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ íƒ€ê²Ÿ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ë³´ì.

```python
fish_target = fish['Species'].to_numpy()

print(fish_target.shape)
print(fish_target[:5])

# ê²°ê³¼ 
(159,)
['Bream' 'Bream' 'Bream' 'Bream' 'Bream']
```

ì´ì œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì™€ í›ˆë ¨ì„¸íŠ¸ë¥¼ ë‚˜ëˆ„ì

```python
from sklearn.model_selection import train_test_split

train_input, test_input, train_target, test_target = train_test_split(
    fish_input, fish_target, random_state=42
)

print(train_input.shape)
print(test_input.shape)
print(train_target.shape)
print(test_target.shape)

# ê²°ê³¼ 
(119, 5)
(40, 5)
(119,)
(40,)
```

ê·¸ í›„, **StandardScaler í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ í‘œì¤€í™” ì „ì²˜ë¦¬** í•œë‹¤. ì—¬ê¸°ì—ì„œë„ í›ˆë ¨ ì„¸íŠ¸ì˜ í†µê³„ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ë³€í™˜í•´ì•¼ í•œë‹¤.

```python
from sklearn.preprocessing import StandardScaler
ss = StandardScaler()
ss.fit(train_input)
train_scaled = ss.transform(train_input)
test_scaled = ss.transform(test_input)

print(train_input[:5])
print(train_scaled[:5])

# ê²°ê³¼ 
[[720.      35.      40.6     16.3618   6.09  ]
 [500.      45.      48.       6.96     4.896 ]
 [  7.5     10.5     11.6      1.972    1.16  ]
 [110.      22.      23.5      5.5225   3.995 ]
 [140.      20.7     23.2      8.5376   3.2944]]
[[ 0.91965782  0.60943175  0.81041221  1.85194896  1.00075672]
 [ 0.30041219  1.54653445  1.45316551 -0.46981663  0.27291745]
 [-1.0858536  -1.68646987 -1.70848587 -1.70159849 -2.0044758 ]
 [-0.79734143 -0.60880176 -0.67486907 -0.82480589 -0.27631471]
 [-0.71289885 -0.73062511 -0.70092664 -0.0802298  -0.7033869 ]]
```

### K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì˜ í™•ë¥  ì˜ˆì¸¡

ì•ì„  ì¥ì—ì„œ í–ˆë˜ ê²ƒì²˜ëŸ¼ KNeighborsClassifier í´ë˜ìŠ¤ ê°ì²´ë¥¼ ë§Œë“¤ê³  í›ˆë ¨ ì„¸íŠ¸ë¡œ ëª¨ë¸ì„ í›ˆë ¨í•œ ë‹¤ìŒ ë‹¤ìŒ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ í™•ì¸í•´ ë³¸ë‹¤.

```python
from sklearn.neighbors import KNeighborsClassifier
# ì´ì›ƒì˜ ê°œìˆ˜ë¥¼ 3ìœ¼ë¡œ ì§€ì •
kn = KNeighborsClassifier(n_neighbors=3)
kn.fit(train_scaled, train_target)

print(kn.score(train_scaled, train_target))
print(kn.score(test_scaled, test_target))

# ê²°ê³¼ 
0.8907563025210085
0.85
```

fish ë°ì´í„° í”„ë ˆì„ì—ì„œ 7ê°œì˜ ìƒì„ ì´ ìˆì—ˆìœ¼ë©°, íƒ€ê²Ÿ ë°ì´í„°ë¥¼ ë§Œë“¤ ë•Œ fish\[Species]ë¥¼ ì‚¬ìš©í•´ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ íƒ€ê²Ÿ ë°ì´í„° ëª¨ë‘ 7ê°œì˜ ìƒì„ ì¢…ë¥˜ê°€ ë“¤ì–´ê°€ ìˆë‹¤. ì´ë ‡ê²Œ **íƒ€ê²Ÿ ë°ì´í„°ì— 2ê°œ ì´ìƒì˜ í´ë˜ìŠ¤ê°€ í¬í•¨ëœ ë¬¸ì œë¥¼ ë‹¤ì¤‘ ë¶„ë¥˜**ë¼ê³  í•œë‹¤.

ì‚¬ì´í‚·ëŸ°ì—ì„œëŠ” ë¬¸ìì—´ë¡œ ëœ íƒ€ê²Ÿê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ íƒ€ê²Ÿê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ì´í‚·ëŸ° ëª¨ë¸ì— ì „ë‹¬í•˜ë©´ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ë§¤ê²¨ì§„ë‹¤. ë•Œë¬¸ì— **KNeighborsClassifierì— ì •ë ¬ëœ íƒ€ê²Ÿ ê°’ì„ ê°€ì§€ëŠ” classes\_ ì†ì„±ì„ ì‚¬ìš©í•œë‹¤.**

```python
print(kn.classes_)

# ê²°ê³¼
['Bream' 'Parkki' 'Perch' 'Pike' 'Roach' 'Smelt' 'Whitefish']
```

predict() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íƒ€ê²Ÿ ê°’ìœ¼ë¡œ ì˜ˆì¸¡ ì¶œë ¥

```python
print(kn.predict(test_scaled[:5]))

# ê²°ê³¼
['Perch' 'Smelt' 'Pike' 'Perch' 'Perch']
```

ì´ 5ê°œì˜ ìƒ˜í”Œì€ ì–´ë–»ê²Œ ë§Œë“¤ì–´ ì¡Œì„ê¹Œ? **ì‚¬ì´í‚·ëŸ°ì˜ ë¶„ë¥˜ ëª¨ë¸ì€ predict\_proba() ë©”ì„œë“œë¡œ í´ë˜ìŠ¤ë³„ í™•ë¥  ê°’ì„ ë°˜í™˜í•œë‹¤.** í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ìˆëŠ” ì²˜ìŒ 5ê°œì˜ ìƒ˜í”Œì— ëŒ€í•œ í™•ë¥ ì„ ì¶œë ¥í•´ë³´ì.

```python
import numpy as np

proba = kn.predict_proba(test_scaled[:5])
print(np.round(proba, decimals=4))

# ê²°ê³¼
[[0.     0.     1.     0.     0.     0.     0.    ]
 [0.     0.     0.     0.     0.     1.     0.    ]
 [0.     0.     0.     1.     0.     0.     0.    ]
 [0.     0.     0.6667 0.     0.3333 0.     0.    ]
 [0.     0.     0.6667 0.     0.3333 0.     0.    ]]
```

predict\_proba() ë©”ì„œë“œì˜ ì¶œë ¥ ìˆœì„œëŠ” ì•ì„œ ë³´ì•˜ë˜ classes\_ ì†ì„±ê³¼ ê°™ë‹¤. ì¦‰, ì²« ë²ˆì§¸ ì—´ì´ â€˜Breamâ€™ì— ëŒ€í•œ í™•ë¥ , ë‘ ë²ˆì§¸ ì—´ì´ â€˜Parkkiâ€™ì— ëŒ€í•œ í™•ë¥ ì´ë‹¤.

<figure><img src="../../.gitbook/assets/5-2.png" alt=""><figcaption></figcaption></figure>

ì´ ëª¨ë¸ì´ ê³„ì‚°í•œ í™•ë¥ ì´ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒì˜ ë¹„ìœ¨ì´ ë§ëŠ”ì§€ í™•ì¸í•˜ì.

```python
distance, indexes = kn.kneighbors(test_scaled[3:4])
print(indexes)
print(train_target[indexes])

# ê²°ê³¼
# ë„¤ ë²ˆì§¸ ìƒ˜í”Œì˜ ìµœê·¼ì ‘ ì´ì›ƒ í´ë˜ìŠ¤ 
[[104 115 106]]
[['Roach' 'Perch' 'Perch']]
```

ì´ ìƒ˜í”Œì˜ ì´ì›ƒì€ ë‹¤ì„¯ ë²ˆì§¸ í´ë˜ìŠ¤ì¸ â€˜Roachâ€™ê°€ 1ê°œì´ê³  ì„¸ ë²ˆì§¸ í´ë˜ìŠ¤ì¸ â€˜Perchâ€™ê°€ 2ê°œì´ë‹¤ .ë”°ë¼ì„œ ë‹¤ì„¯ ë²ˆì§¸ í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì€ 1/3 = 0.3333ì´ê³  ì„¸ ë²ˆì§¸ í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì€ 2/3 = 0.6667ì´ ëœë‹¤. ì•ì„œ ì¶œë ¥í•œ ë„¤ ë²ˆì§¸ ìƒ˜í”Œì˜ í´ë˜ìŠ¤ í™•ë¥ ê³¼ ê°™ë‹¤.

ê·¸ëŸ°ë° ë­”ê°€ ì¢€ ì´ìƒí•˜ë‹¤. 3ê°œì˜ ìµœê·¼ì ‘ ì´ì›ƒë§Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— í™•ë¥ ì´ ë„ˆë¬´ ë‹¨ì¡°ë¡­ê²Œ í˜ëŸ¬ê°„ë‹¤. ex) 0/3, 1/3, 2/3, 3/3ì´ ì „ë¶€ì´ë‹¤. ì–´ìƒ‰í•œ ë¶€ë¶„ì„ ìˆ˜ì •í•´ë³´ì.

### ë¡œì§€ìŠ¤í‹± íšŒê·€

* ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” ì´ë¦„ì€ íšŒê·€ì´ì§€ë§Œ ë¶„ë¥˜ ëª¨ë¸ì´ë‹¤.
* ì„ í˜• íšŒê·€ì™€ ë™ì¼í•˜ê²Œ ì„ í˜• ë°©ì •ì‹ì„ í•™ìŠµí•œë‹¤.

<figure><img src="../../.gitbook/assets/5-3.png" alt=""><figcaption></figcaption></figure>

**z ê°’ì´ ì•„ì£¼ í° ìŒìˆ˜ ì¼ ë•ŒëŠ” 0 ì•„ì£¼ í° ì–‘ìˆ˜ ì¼ ë•ŒëŠ” 1ì´ ë˜ë ¤ë©´ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜**ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ëŠ” zê°€ ë¬´í•œí•˜ê²Œ í° ìŒìˆ˜ì¼ ê²½ìš° 0ì— ê°€ê¹Œì›Œì§€ê³ , zê°€ ë¬´í•œí•˜ê²Œ í° ì–‘ìˆ˜ê°€ ë  ë•ŒëŠ” 1ì— ê°€ê¹Œì›Œ ì§„ë‹¤. zê°€ 0ì´ ë  ë•ŒëŠ” 0.5ê°€ ëœë‹¤. zê°€ ì–´ë–¤ ê°’ì´ ë˜ë”ë¼ë„ ì ˆëŒ€ë¡œ 0\~1ì‚¬ì´ë¥¼ ë²—ì–´ë‚  ìˆ˜ ì—†ë‹¤. ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë³´ì.

```python
import numpy as np
import matplotlib.pyplot as plt

z = np.arange(-5, 5, 0.1)
phi = 1 / (1+np.exp(-z))
plt.plot(z, phi)
plt.xlabel('z')
plt.ylabel('phi')
plt.show()
```

<figure><img src="../../.gitbook/assets/5-4.png" alt=""><figcaption></figcaption></figure>

ì´ì œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨í•˜ê¸° ì „ì— ê°„ë‹¨í•œ ì´ì§„ ë¶„ë¥˜ë¥¼ ìˆ˜í–‰í•´ë³´ì. ì´ì§„ ë¶„ë¥˜ì— ê²½ìš° ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì˜ ì¶œë ¥ì´ 0.5ë³´ë‹¤ í¬ë©´ ì–‘ì„± í´ë˜ìŠ¤, 0.5 ë³´ë‹¤ ì‘ìœ¼ë©´ ìŒì„± í´ë˜ìŠ¤ë¡œ íŒë‹¨í•œë‹¤. ê·¸ëŸ¼ ë¨¼ì € ë„ë¯¸ì™€ ë¹™ì–´ 2ê°œë¥¼ ì‚¬ìš©í•´ ì´ì§„ ë¶„ë¥˜ë¥¼ í•´ë³´ì.

```python
char_arr = np.array(['A','B','C','D','E'])
print(char_arr[[True,False,True,False,False]])

# ê²°ê³¼
['A' 'C']
```

ì´ì™€ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í•´ í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ë„ë¯¸ì™€ ë¹™ì–´ì˜ í–‰ë§Œ ê³¨ë¼ëƒˆë‹¤. ë¹„êµ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ë©´ ë„ë¯¸ì™€ ë¹™ì–´ì˜ í–‰ì„ ëª¨ë‘ Trueë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ **ë„ë¯¸ì¸ í–‰ì„ ê³¨ë¼ë‚´ë ¤ë©´ train\_target == â€˜Breamâ€™ê³¼ ê°™ì´ ì‚¬ìš©í•œë‹¤. ì´ ë¹„êµì‹ìœ¼ë¡œ Breamì¸ ê²ƒì€ True ë‚˜ë¨¸ì§€ëŠ” Falseì¸ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤. ë„ë¯¸ì™€ ë¹™ì–´ì— ëŒ€í•œ ë¹„êµ ê²°ê³¼ë¥¼ ë¹„íŠ¸ or ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ í•©ì¹˜ë©´ ë„ë¯¸ì™€ ë¹™ì–´ì— ëŒ€í•œ í–‰ë§Œ ê³¨ë¼ë‚¼ ìˆ˜ ìˆë‹¤.**

```python
bream_smelt_indexes = (train_target == 'Bream') | (train_target == 'Smelt')

train_bream_smelt = train_scaled[bream_smelt_indexes]
target_bream_smelt = train_target[bream_smelt_indexes]

print(train_bream_smelt.shape)
print(target_bream_smelt.shape)
print(target_bream_smelt)

# ê²°ê³¼
(33, 5)
(33,)
['Bream' 'Smelt' 'Bream' 'Bream' 'Bream' 'Smelt' 'Bream' 'Bream' 'Bream'
 'Bream' 'Bream' 'Bream' 'Bream' 'Smelt' 'Bream' 'Smelt' 'Smelt' 'Bream'
 'Bream' 'Bream' 'Bream' 'Bream' 'Bream' 'Bream' 'Bream' 'Smelt' 'Bream'
 'Smelt' 'Smelt' 'Bream' 'Smelt' 'Bream' 'Bream']
```

ì´ì œ ì´ ë°ì´í„°ë¡œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨ í•´ë³´ì. **LogisticRegression í´ë˜ìŠ¤ëŠ” ì„ í˜• ëª¨ë¸ì´ë¯€ë¡œ sklearn.linear\_model íŒ¨í‚¤ì§€ ì•„ë˜**ìˆë‹¤.

```python
from sklearn.linear_model import LogisticRegression

lr = LogisticRegression()
lr.fit(train_bream_smelt, target_bream_smelt)

print(lr.predict(train_bream_smelt[:5]))

# ê²°ê³¼ 
['Bream' 'Smelt' 'Bream' 'Bream' 'Bream']
```

ë‘ ë²ˆì§¸ ìƒ˜í”Œì„ ì œì™¸í•˜ê³ ëŠ” ëª¨ë‘ ë„ë¯¸ë¡œ ì˜ˆì¸¡í–ˆë‹¤. **KNeighborsClassifierì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì˜ˆì¸¡ í™•ë¥ ì€ predict\_proba() ë©”ì„œë“œë¥¼ ì œê³µ**í•œë‹¤. train\_bream\_smeltì—ì„œ ì²˜ìŒ 5ê°œ ìƒ˜í”Œì˜ ì˜ˆì¸¡ í™•ë¥ ì„ ì¶œë ¥ í•´ë³´ì.

```python
print(lr.predict_proba(train_bream_smelt[:5]))

# ê²°ê³¼
[[0.99759855 0.00240145]
 [0.02735183 0.97264817]
 [0.99486072 0.00513928]
 [0.98584202 0.01415798]
 [0.99767269 0.00232731]]
```

ìƒ˜í”Œë§ˆë‹¤ 2ê°œì˜ í™•ë¥ ì´ ì¶œë ¥ë˜ì—ˆë‹¤. ì²« ë²ˆì§¸ ì—´ì´ ìŒì„± í´ë˜ìŠ¤(0), ë‘ ë²ˆì§¸ ì—´ì´ ì–‘ì„± í´ë˜ìŠ¤(1)ì˜ í™•ë¥ ì´ë‹¤. ë„ë¯¸ì™€ ë¹™ì–´ ì¤‘ ì–´ë–¤ ê²ƒì´ ì–‘ì„± í´ë˜ìŠ¤ ì¼ê¹Œ? ì•ì— k-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì—ì„œ ë³´ì•˜ë“¯ì´ ì‚¬ì´í‚·ëŸ°ì€ íƒ€ê²Ÿê°’ì„ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬í•œë‹¤. classes\_ì†ì„±ìœ¼ë¡œ í™•ì¸í•´ë³´ì.

```python
print(lr.classes_)

# ê²°ê³¼
['Bream' 'Smelt']
```

ë¹™ì–´ê°€ ì–‘ì„±í´ë˜ìŠ¤ ì´ë‹¤. predict\_proba() ë©”ì„œë“œê°€ ë°˜í™˜í•œ ë°°ì—´ ê°’ì„ ë³´ë©´ ë‘ ë²ˆì§¸ ìƒ˜í”Œë§Œ ì–‘ì„± í´ë˜ìŠ¤ì¸ ë¹™ì–´ì˜ í™•ë¥ ì´ ë†’ë‹¤. ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ ë„ë¯¸ë¡œ ì˜ˆì¸¡í•  ê²ƒì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì„ í˜• íšŒê·€ì—ì„œ í–ˆë˜ ê²ƒì²˜ëŸ¼ ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ í•™ìŠµí•œ ê³„ìˆ˜ë¥¼ í™•ì¸ í•´ë³´ì.

```python
print(lr.coef_, lr.intercept_)

# ê²°ê³¼
[[-0.4037798  -0.57620209 -0.66280298 -1.01290277 -0.73168947]] [-2.16155132]
```

ë”°ë¼ì„œ, ì´ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì´ í•™ìŠµí•œ ë°©ì •ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

<figure><img src="../../.gitbook/assets/5-5.png" alt=""><figcaption></figcaption></figure>

ê·¸ë ‡ë‹¤ë©´ LogisticRegression ëª¨ë¸ë¡œ z ê°’ì„ ê³„ì‚° í•´ë³¼ ìˆ˜ ìˆì„ê¹Œ? LogisticRegression í´ë˜ìŠ¤ëŠ” decision\_function() ë©”ì„œë“œë¡œ z ê°’ì„ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤. train\_bream\_smeltì˜ ì²˜ìŒ 5ê°œ ìƒ˜í”Œì˜ zê°’ì„ ì¶œë ¥ í•´ë³´ì.

```python
decisions = lr.decision_function(train_bream_smelt[:5])
print(decisions)

# ê²°ê³¼ 
[-6.02927744  3.57123907 -5.26568906 -4.24321775 -6.0607117 ]
```

ì´ì œ ì´ zê°’ì„ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì— í†µê³¼ì‹œí‚¤ë©´ í™•ë¥ ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. íŒŒì´ì¬ ì‚¬ì´íŒŒì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ìˆëŠ” expit()ë¥¼ ì´ìš©í•´ np.exp()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ decisions ë°°ì—´ì˜ ê°’ì„ í™•ë¥ ë¡œ ë³€í™˜ í•´ë³´ì.

```python
from scipy.special import expit
print(expit(decisions))

# ê²°ê³¼
[0.00240145 0.97264817 0.00513928 0.01415798 0.00232731]
```

ì¶œë ¥ëœ ê°’ì„ ë³´ë©´ predict\_proba() ë©”ì„œë“œ ì¶œë ¥ì˜ ë‘ ë²ˆì§¸ ì—´ì˜ ê°’ê³¼ ë™ì¼í•˜ë‹¤ ë”°ë¼ì„œ decision\_function() ë©”ì„œë“œëŠ” ì–‘ì„± í´ë˜ìŠ¤ì— ëŒ€í•œ z ê°’ì„ ë°˜í™˜í•œë‹¤.

ì´ì œ ì´ì§„ ë¶„ë¥˜ì˜ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ 7ê°œì˜ ìƒì„ ì„ ë¶„ë¥˜í•˜ëŠ” ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œë¡œ ë„˜ì–´ê°€ ë³´ì.

ë‹¤ìŒ ì½”ë“œëŠ” LogisticRegression í´ë˜ìŠ¤ë¡œ ë‹¤ì¤‘ ë¶„ë¥˜ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ì½”ë“œì´ë‹¤.

```python
lr2 = LogisticRegression (C=20, max_iter=1000)

lr2.fit(train_scaled, train_target)
print(lr2.score(train_scaled, train_target))
print(lr2.score(test_scaled, test_target))

# ê²°ê³¼ 
0.9327731092436975
0.925

# ë°˜ë³µì ì¸ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©, max_iter ë§¤ê°œë³€ìˆ˜ ì¡°ì •  100 -> 1000
# L2 ê·œì œ(ê³„ìˆ˜ì˜ ì œê³±ì„ ê·œì œ) ì‚¬ìš©, ë§¤ê°œë³€ìˆ˜ C ì¡°ì • 1 -> 20 (ê·œì œ ì™„í™”)
```

í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ëŒ€í•œ ì ìˆ˜ê°€ ë†’ê³  ê³¼ëŒ€ ì í•©ì´ë‚˜ ê³¼ì†Œ ì í•©ì´ ì•„ë‹Œ ê²ƒ ê°™ë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ì œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ì²˜ìŒ 5ê°œ ìƒ˜í”Œì— ëŒ€í•œ ì˜ˆì¸¡ì„ ì¶œë ¥í•´ë³´ì.

```python
print(lr2.predict(test_scaled[:5]))

# ê²°ê³¼ 
['Perch' 'Smelt' 'Pike' 'Roach' 'Perch']
```

ì´ë²ˆì—ëŠ” í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì²˜ìŒ 5ê°œ ìƒ˜í”Œì— ëŒ€í•œ ì˜ˆì¸¡ í™•ë¥ ì„ ì¶œë ¥í•´ ë³´ì.

```python
proba = lr2.predict_proba(test_scaled[:5])
print(np.round(proba, decimals=3))

# ê²°ê³¼
[[0.    0.014 0.841 0.    0.136 0.007 0.003]
 [0.    0.003 0.044 0.    0.007 0.946 0.   ]
 [0.    0.    0.034 0.935 0.015 0.016 0.   ]
 [0.011 0.034 0.306 0.007 0.567 0.    0.076]
 [0.    0.    0.904 0.002 0.089 0.002 0.001]]
```

5ê°œ ìƒ˜í”Œì— ëŒ€í•œ ì˜ˆì¸¡ì´ë¯€ë¡œ 5ê°œì˜ í–‰, ë˜ 7ê°œì˜ ìƒì„ ì— ëŒ€í•œ í™•ë¥  ì´ë¯€ë¡œ 7ê°œì˜ ì—´ì´ ì¶œë ¥ ë˜ì—ˆë‹¤.

ìœ„ ê²°ê³¼ì— ì²« ë²ˆì§¸ ìƒ˜í”Œì„ ë³´ë©´ ì„¸ ë²ˆì§¸ ì—´ í™•ë¥ ì´ ê°€ì¥ ë†’ë‹¤. classes\_ì†ì„±ì„ ì‚¬ìš©í•´ ì–´ë–¤ ë¬¼ê³ ê¸°ì¸ì§€ ì•Œì•„ë³´ì.

```python
print(lr2.classes_)

# ê²°ê³¼ 
['Bream' 'Parkki' 'Perch' 'Pike' 'Roach' 'Smelt' 'Whitefish']
```

ì²« ë²ˆì§¸ ìƒ˜í”Œì—ì„œ ë‚˜ì˜¬ ë¬¼ê³ ê¸°ì˜ ê°€ì¥ ë†’ì€ í™•ë¥ ì€ ë†ì–´(Perch)ì˜€ë‹¤. ë‹¤ì¤‘ ë¶„ë¥˜ì— ê²½ìš° ì„ í˜• ë°©ì •ì‹ì€ ì–´ë–¤ ëª¨ìŠµì¼ê¹Œ? coef\_ì™€ intercept\_ì˜ í¬ê¸°ë¥¼ ì¶œë ¥í•´ë³´ì.

```python
print(lr2.coef_.shape, lr2.intercept_.shape)

# ê²°ê³¼
(7, 5) (7,)
```

ì´ ë°ì´í„°ëŠ” 5ê°œì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ë¯€ë¡œ coef\_ ë°°ì—´ì˜ ì—´ì€ 5ê°œì´ë‹¤. ê·¸ëŸ°ë° í–‰ì´ 7ìœ¼ë¡œ ë‚˜ì™”ë‹¤. interceptë˜í•œ ë§ˆì°¬ê°€ì§€ì´ë‹¤. **ì´ ë§ì€ ì´ì§„ ë¶„ë¥˜ì—ì„œ ë³´ì•˜ë˜ zë¥¼ 7ê°œë‚˜ ê³„ì‚°í•œë‹¤ëŠ” ì˜ë¯¸**ì´ë‹¤. ë‹¤ì¤‘ ë¶„ë¥˜ëŠ” í´ë˜ìŠ¤ë§ˆë‹¤ z ê°’ì„ í•˜ë‚˜ì”© ê³„ì‚°í•˜ë©°, **ê°€ì¥ ë†’ì€ z ê°’ì„ ì¶œë ¥í•˜ëŠ” í´ë˜ìŠ¤ê°€ ì˜ˆì¸¡ í´ë˜ìŠ¤**ê°€ ëœë‹¤. ê·¸ë ‡ë‹¤ë©´ í™•ë¥ ì€ ì–´ë–»ê²Œ ê³„ì‚°í•œ ê²ƒì¼ê¹Œ? **ì´ì§„ ë¶„ë¥˜ì—ì„œëŠ” ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ zë¥¼ 0ê³¼ 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ë³€í™˜í–ˆë‹¤. ë‹¤ì¤‘ ë¶„ë¥˜ëŠ” ì´ì™€ ë‹¬ë¦¬ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ 7ê°œì˜ z ê°’ì„ í™•ë¥ ë¡œ ë³€í™˜í•œë‹¤.**

### ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë€?

> **ì—¬ëŸ¬ ê°œì˜ ì„ í˜• ë°©ì •ì‹ ì¶œë ¥ ê°’ì„ 0\~1ë¡œ ì••ì¶•í•˜ê³ , ì „ì²´ í•©ì„ 1ë¡œ ì¡°ì •**

<figure><img src="../../.gitbook/assets/5-6.png" alt=""><figcaption></figcaption></figure>

ê·¸ë ‡ë‹¤ë©´ ì´ì§„ ë¶„ë¥˜ì—ì„œì²˜ëŸ¼ **decision\_function() ë©”ì„œë“œë¡œ z1\~z7ê¹Œì§€ì˜ ê°’ì„ êµ¬í•œ ë‹¤ìŒ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ í™•ë¥ ë¡œ ë°”ê¾¸ì–´ ë³´ì.**

```python
decision = lr2.decision_function(test_scaled[:5])
print(np.round(decision, decimals=2))

# ê²°ê³¼
[[ -6.5    1.03   5.16  -2.73   3.34   0.33  -0.63]
 [-10.86   1.93   4.77  -2.4    2.98   7.84  -4.26]
 [ -4.34  -6.23   3.17   6.49   2.36   2.42  -3.87]
 [ -0.68   0.45   2.65  -1.19   3.26  -5.75   1.26]
 [ -6.4   -1.99   5.82  -0.11   3.5   -0.11  -0.71]]
```

ì‚¬ì´íŒŒì´ì˜ ì†Œí”„íŠ¸ë§¥ìˆ˜ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ê²°ê³¼ë¥¼ ë³´ì. **scipy.special ì•„ë˜ì— softmax() í•¨ìˆ˜ë¥¼ ì„í¬íŠ¸**í•˜ì—¬ ì‚¬ìš©í•œë‹¤.

```python
from scipy.special import softmax
proba = softmax(decision, axis=1)
print(np.round(proba, decimals=3))

# ê²°ê³¼
[[0.    0.014 0.841 0.    0.136 0.007 0.003]
 [0.    0.003 0.044 0.    0.007 0.946 0.   ]
 [0.    0.    0.034 0.935 0.015 0.016 0.   ]
 [0.011 0.034 0.306 0.007 0.567 0.    0.076]
 [0.    0.    0.904 0.002 0.089 0.002 0.001]]
```

ì¶œë ¥ ê²°ê³¼ë¥¼ ì•ì„œ êµ¬í•œ proba ë°°ì—´ê³¼ ë¹„êµí•´ë³´ì. ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ëª¨ìŠµì´ë‹¤.

## 5ì£¼ì°¨ 2ë²ˆì§¸ ìˆ˜ì—…

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

ìˆ˜ì‚°ë¬¼ ê³µê¸‰ì²˜ í™•ëŒ€, ì¶”ê°€ëœ ìˆ˜ì‚°ë¬¼ì— ëŒ€í•œ ìƒ˜í”Œ ì¶”ê°€ í•™ìŠµ í•„ìš”

í›ˆë ¨ ë°ì´í„°ê°€ ì¡°ê¸ˆì”© ì „ë‹¬ë˜ëŠ” ìƒí™© í•´ê²°

* ê¸°ì¡´ ë°ì´í„°ì— ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì—¬ ë§¤ì¼ ì¬í›ˆë ¨ â† ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë°ì´í„° ëŠ˜ì–´ë‚¨
* ìƒˆë¡œìš´ ë°ì´í„° ì¶”ê°€ ì‹œ ê¸°ì¡´ ë°ì´í„° ì¼ë¶€ ì œê±°(ë°ì´í„° í¬ê¸° ìœ ì§€) â† ì¤‘ìš” ë°ì´í„° ì‚­ì œ ìœ„í—˜
* ê¸°ì¡´ í›ˆë ¨ ëª¨ë¸ì„ ìœ ì§€í•˜ê³ , ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•´ ì¶”ê°€ í›ˆë ¨(ì ì§„ì  í•™ìŠµ)

**ëŒ€í‘œì ì¸ ì ì§„ì  í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì€ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•**ì´ ìˆë‹¤.

### í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì´ë€?

> ê¸°ê³„ í•™ìŠµì—ì„œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ë¡œ, **ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•˜ì—¬ ì†ì‹¤ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ë°©ë²•**

* ëŒ€í‘œì ì¸ ì ì§„ì  í•™ìŠµ ì•Œê³ ë¦¬ì¦˜
* í™•ë¥ ì  : â€˜ë¬´ì‘ìœ„ í•˜ê²Œâ€™, â€˜ëœë¤ í•˜ê²Œâ€™ ì˜ë¯¸
* ê²½ì‚¬ í•˜ê°•ë²• : ê²½ì‚¬(ê¸°ìš¸ê¸°)ë¥¼ ë”°ë¼ ë‚´ë ¤ê°€ëŠ” ë°©ë²•
* ê°€ì¥ ê°€íŒŒë¥¸ ê²½ì‚¬ë¥¼ ë”°ë¼ ì›í•˜ëŠ” ì§€ì ì— ë„ë‹¬í•˜ëŠ” ê²ƒì´ ëª©í‘œ
* ê°€ì¥ ê°€íŒŒë¥¸ ê¸¸ì„ ì°¾ì•„ ë‚´ë ¤ì˜¤ì§€ë§Œ ì¡°ê¸ˆì”© ë‚´ë ¤ ì˜¤ëŠ” ê²ƒì´ ì¤‘ìš”

### **ì—í¬í¬(epoch)ë€?**

> **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì—ì„œ í›ˆë ¨ ì„¸íŠ¸ë¥¼ í•œ ë²ˆ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” ê³¼ì •ì„ ì—í¬í¬ ë¼ê³  í•œë‹¤.**

### ë‹¤ì–‘í•œ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•

* í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• : ë¬´ì‘ìœ„ë¡œ 1ê°œì”© ìƒ˜í”Œ ì„ íƒ
* ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• : ë¬´ì‘ìœ„ë¡œ ëª‡ê°œì”© ìƒ˜í”Œ ì„ íƒ(ì‹¤ì „ì—ì„œ ë§ì´ ì‚¬ìš©)
* ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• : ì „ì²´ ìƒ˜í”Œ ì„ íƒ

<figure><img src="../../.gitbook/assets/5-7.png" alt=""><figcaption></figcaption></figure>

**ì‹ ê²½ë§ ì•Œê³ ë¦¬ì¦˜ì—ì„  ê²½ì‚¬ í•˜ê°•ë²•ì„ í•„ìˆ˜ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.**

### ì†ì‹¤ í•¨ìˆ˜ë€?

> **ì ìš© ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì´ ì–¼ë§ˆë‚˜ ì—‰í„°ë¦¬ì¸ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê¸°ì¤€**

* ê°’ì´ ì‘ì„ ìˆ˜ë¡ ìš°ìˆ˜
* ë¹„ìš© í•¨ìˆ˜(cost function) ë¼ê³ ë„ í•¨
* ë¶„ë¥˜ì—ì„œ ì†ì‹¤ : ì •ë‹µì„ ë§ì¶”ì§€ ëª»í•˜ëŠ” ê²ƒ
* ê²½ì‚¬ í•˜ê°•ë²•ì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì†ì‹¤ í•¨ìˆ˜ ê°’ì´ ì—°ì†ì  ì´ì–´ì•¼ í•¨
* ì†ì‹¤ í•¨ìˆ˜ëŠ” ë¯¸ë¶„ ê°€ëŠ¥í•´ì•¼ í•¨
* ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì˜ í™•ë¥  ì¶œë ¥ì„ í†µí•´ ì—°ì†ì ì¸ ì†ì‹¤ í•¨ìˆ˜ êµ¬ì„±

### ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜

* ì–‘ì„± í´ë˜ìŠ¤\*\*(íƒ€ê¹ƒ=1)ì¼ ë•Œ : -log(ì˜ˆì¸¡í™•ë¥ )í™•ë¥ ì´ 1ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ ì†ì‹¤ì€ ì•„ì£¼ í° ì–‘ìˆ˜\*\*ê°€ ëœë‹¤.
* ìŒì„± í´ë˜ìŠ¤\*\*(íƒ€ê¹ƒ=0)ì¼ ë•Œ : -log(1-ì˜ˆì¸¡í™•ë¥ )í™•ë¥ ì´ 0ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ ì†ì‹¤ì€ ì•„ì£¼ í° ì–‘ìˆ˜\*\*ê°€ ëœë‹¤.

### ê·¸ë ‡ë‹¤ë©´ ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì!

```python
import numpy as np
import matplotlib.pyplot as plt

y = 1
p = np.arange(0,1,0.01)
z = -(y*np.log10(p) + (1-y)*np.log10(1-p))

plt.grid(True)
plt.plot(p,z)
plt.show()
```

<figure><img src="../../.gitbook/assets/5-8.png" alt=""><figcaption></figcaption></figure>

```python
import numpy as np
import matplotlib.pyplot as plt

import numpy as np
import matplotlib.pyplot as plt

y = 0
p = np.arange(0,1,0.01)
z = -(y*np.log10(p) + (1-y)*np.log10(1-p))

plt.grid(True)
plt.plot(p,z)
plt.show()
```

<figure><img src="../../.gitbook/assets/5-9.png" alt=""><figcaption></figcaption></figure>

ì´ëŸ¬í•œ ì†ì‹¤í•¨ìˆ˜ë¥¼ **ë¡œì§€ìŠ¤í‹± ì†ì‹¤í•¨ìˆ˜** ë˜ëŠ” **ì´ì§„ í¬ë¡œìŠ¤ì—”íŠ¸ë¡œí”¼ ì†ì‹¤ í•¨ìˆ˜** ë¼ê³  ë¶€ë¥¸ë‹¤.

**ì†ì‹¤ í•¨ìˆ˜ì˜ ë¶„ë¥˜**

* í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ ì†ì‹¤ í•¨ìˆ˜
* Binary cross-entropy, categorical cross-entropy

**ì†ì‹¤ í•¨ìˆ˜ì˜ íšŒê·€**

* í‰ê·  ì ˆëŒ€ ì˜¤ì°¨
* í‰ê·  ì œê³± ì˜¤ì°¨
* í‰ê·  ì œê³±ê·¼ ì˜¤ì°¨

### í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì„ ì‚¬ìš©í•œ ë¶„ë¥˜ ëª¨ë¸ì„ ë§Œë“¤ì–´ë³´ì!

ë¨¼ì €, **fish\_csv\_data íŒŒì¼ì—ì„œ íŒë‹¤ìŠ¤ ë°ì´í„°í”„ë ˆì„ì„ ë§Œë“ ë‹¤.**

```python
import pandas as pd

fish = pd.read_csv("<https://bit.ly/fish_csv_data>")
print(fish.shape)
print(fish.head)

# ê²°ê³¼
(159, 6)
<bound method NDFrame.head of     Species  Weight  Length  Diagonal   Height   Width
0     Bream   242.0    25.4      30.0  11.5200  4.0200
1     Bream   290.0    26.3      31.2  12.4800  4.3056
2     Bream   340.0    26.5      31.1  12.3778  4.6961
3     Bream   363.0    29.0      33.5  12.7300  4.4555
4     Bream   430.0    29.0      34.0  12.4440  5.1340
..      ...     ...     ...       ...      ...     ...
154   Smelt    12.2    12.2      13.4   2.0904  1.3936
155   Smelt    13.4    12.4      13.5   2.4300  1.2690
156   Smelt    12.2    13.0      13.8   2.2770  1.2558
157   Smelt    19.7    14.3      15.2   2.8728  2.0672
158   Smelt    19.9    15.0      16.2   2.9322  1.8792

[159 rows x 6 columns]>
```

ê·¸ ë‹¤ìŒ, Species ì—´ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ 5ê°œëŠ” ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©í•œë‹¤. Species ì—´ì€ íƒ€ê²Ÿ ë°ì´í„°ì´ë‹¤.

```python
fish_input = fish[['Weight', 'Length','Diagonal','Height','Width']].to_numpy()

print(fish_input.shape)
print(fish_input[:5])

# ê²°ê³¼
(159, 5)
[[242.      25.4     30.      11.52     4.02  ]
 [290.      26.3     31.2     12.48     4.3056]
 [340.      26.5     31.1     12.3778   4.6961]
 [363.      29.      33.5     12.73     4.4555]
 [430.      29.      34.      12.444    5.134 ]]
fish_input = fish[['Weight', 'Length','Diagonal','Height','Width']].to_numpy()

print(fish_input.shape)
print(fish_input[:5])

# ê²°ê³¼
(159,)
['Bream' 'Bream' 'Bream' 'Bream' 'Bream']
```

ì‚¬ì´í‚·ëŸ°ì˜ train\_test\_split() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì´ ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆˆë‹¤.

```python
from sklearn.model_selection import train_test_split

train_input, test_input, train_target, test_target = train_test_split(fish_input, fish_target, random_state=42)

print(train_input.shape)
print(test_input.shape)
print(train_target[:5])
print(test_target[:5])

# ê²°ê³¼
(119, 5)
(40, 5)
['Bream' 'Pike' 'Smelt' 'Perch' 'Parkki']
['Perch' 'Smelt' 'Pike' 'Whitefish' 'Perch']
```

ì´ì œ, í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ íŠ¹ì„±ì„ í‘œì¤€í™” ì „ì²˜ë¦¬í•œë‹¤. ë‹¤ì‹œ í•œë²ˆ ê°•ì¡°í•˜ì§€ë§Œ ê¼­ **í›ˆë ¨ ì„¸íŠ¸ì—ì„œ í•™ìŠµí•œ í†µê³„ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë„ ë³€í™˜í•´ì•¼ í•œë‹¤.**

```python
from sklearn.preprocessing import StandardScaler

ss = StandardScaler()
ss.fit(train_input)
train_scaled = ss.transform(train_input)
test_scaled = ss.transform(test_input)

print(train_input[:5])
print(train_scaled[:5])

# ê²°ê³¼
[[720.      35.      40.6     16.3618   6.09  ]
 [500.      45.      48.       6.96     4.896 ]
 [  7.5     10.5     11.6      1.972    1.16  ]
 [110.      22.      23.5      5.5225   3.995 ]
 [140.      20.7     23.2      8.5376   3.2944]]
[[ 0.91965782  0.60943175  0.81041221  1.85194896  1.00075672]
 [ 0.30041219  1.54653445  1.45316551 -0.46981663  0.27291745]
 [-1.0858536  -1.68646987 -1.70848587 -1.70159849 -2.0044758 ]
 [-0.79734143 -0.60880176 -0.67486907 -0.82480589 -0.27631471]
 [-0.71289885 -0.73062511 -0.70092664 -0.0802298  -0.7033869 ]]
```

ì‚¬ì´í‚·ëŸ°ì—ì„œ **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì„ ì œê³µí•˜ëŠ” ëŒ€í‘œì ì¸ ë¶„ë¥˜ìš© í´ë˜ìŠ¤ëŠ” SGDClassifierì´ë‹¤.** **SGDClassifierì˜ ê°ì²´ë¥¼ ë§Œë“¤ ë•Œ 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì§€ì •**í•œë‹¤. **lossëŠ” ì†ì‹¤ í•¨ìˆ˜ì˜ ì¢…ë¥˜ë¥¼ ì§€ì •**í•œë‹¤. ì—¬ê¸°ì—ì„œëŠ” loss=â€™log\_lossâ€™ë¡œ ì§€ì •í•˜ì—¬ ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜ë¥¼ ì§€ì •í–ˆë‹¤. **max\_iterëŠ” ìˆ˜í–‰í•  ì—í¬í¬ íšŸìˆ˜ë¥¼ ì§€ì •**í•œë‹¤. 10ìœ¼ë¡œ ì§€ì •í•˜ì—¬ ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ë¥¼ 10íšŒ ë°˜ë³µí•˜ê³ , ê·¸ í›„ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œ ì •í™•ë„ ì ìˆ˜ë¥¼ ì¶œë ¥í•˜ì.

```python
from sklearn.linear_model import SGDClassifier

sc = SGDClassifier(loss="log", max_iter=10, random_state=42)
sc.fit(train_scaled, train_target)
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))

# ê²°ê³¼
0.773109243697479
0.775
```

ì¶œë ¥ëœ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì •í™•ë„ê°€ ë‚®ë‹¤ â†’ ì•„ë§ˆë„ **ì—í¬í¬ì˜ íšŸìˆ˜ ë¶€ì¡±ì´ ì›ì¸ì¼ ê²ƒì´ë‹¤.**

ì•ì„œ ë§í•œ ê²ƒì²˜ëŸ¼ **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì€ ì ì§„ì  í•™ìŠµì´ ê°€ëŠ¥**í•˜ë‹¤. SGDClassifier ê°ì²´ë¥¼ ë‹¤ì‹œ ë§Œë“¤ì§€ ì•Šê³ , í›ˆë ¨í•œ ëª¨ë¸ scë¥¼ ì¶”ê°€ë¡œ ë” í›ˆë ¨ í•´ë³´ì. **ëª¨ë¸ì„ ì´ì–´ì„œ í›ˆë ¨í•  ë•ŒëŠ” partial\_fit() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. ì´ ë©”ì„œë“œëŠ” fit() ë©”ì„œë“œì™€ ì‚¬ìš©ë²•ì´ ê°™ì§€ë§Œ í˜¸ì¶œí•  ë•Œ ë§ˆë‹¤ 1 ì—í¬í¬ì”© ì´ì–´ì„œ í›ˆë ¨í•  ìˆ˜ ìˆë‹¤.**

```python
sc.partial_fit(train_scaled, train_target)
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))

# ê²°ê³¼
0.8151260504201681
0.85
```

ì•„ì§ ì ìˆ˜ê°€ ë‚®ì§€ë§Œ ì—í¬í¬ë¥¼ í•œ ë²ˆ ë” ì‹¤í–‰í•˜ë‹ˆ ì •í™•ë„ê°€ í–¥ìƒë˜ì—ˆë‹¤. ì´ ëª¨ë¸ì„ ì—¬ëŸ¬ ì—í¬í¬ì—ì„œ ë” í›ˆë ¨í•´ ë³¼ í•„ìš”ê°€ ìˆì„ ê²ƒ ê°™ë‹¤. ë˜í•œ ë¬´ì‘ì • ë°˜ë³µí•  ìˆ˜ëŠ” ì—†ìœ¼ë‹ˆ ì–´ë–¤ ê¸°ì¤€ì´ í•„ìš”í•  ê²ƒì´ë‹¤.

### ì—í¬í¬ì˜ ê³¼ëŒ€ ì í•©/ê³¼ì†Œì í•©

**í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• ì‚¬ìš© ëª¨ë¸**

* ì—í¬í¬ íšŸìˆ˜ì— ë”°ë¼ ê³¼ì†Œì í•© ë˜ëŠ” ê³¼ëŒ€ì í•© ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤.
* ì ì ˆí•œ ì—í¬í¬ íšŸìˆ˜ë¥¼ ì°¾ì•„ì•¼ í•œë‹¤.
* ê³¼ëŒ€ì í•©ì´ ë˜ê¸° ì „ì— í›ˆë ¨ì„ ë©ˆì¶”ëŠ” ê²ƒì„ **ì¡°ê¸° ì¢…ë£Œ**ë¼ê³  í•œë‹¤.

<figure><img src="../../.gitbook/assets/5-10.png" alt=""><figcaption></figcaption></figure>

300ë²ˆì˜ ì—í¬í¬ ë™ì•ˆ ê¸°ë¡í•œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ ê·¸ë˜í”„ë¡œ ê·¸ë ¤ë³´ì.

```python
import numpy as np

sc2 = SGDClassifier(loss="log_loss", random_state=42)
train_score = []
test_score = []
classes = np.unique(train_target)

for _ in range(0, 300) :
  sc2.partial_fit(train_scaled, train_target, classes=classes)
  train_score.append(sc2.score(train_scaled, train_target))
  test_score.append(sc2.score(test_scaled, test_target))

import matplotlib.pyplot as plt
plt.plot(train_score, label="train set")
plt.plot(test_score, label="test set")
plt.legend
plt.show()
# 100ë²ˆì§¸ ì—í¬í¬ ì ì •
```

<figure><img src="../../.gitbook/assets/5-11.png" alt=""><figcaption></figcaption></figure>

ê·¸ë ‡ë‹¤ë©´ SGDClassifierì˜ ë°˜ë³µ íšŸìˆ˜ë¥¼ 100ì— ë§ì¶”ê³  ëª¨ë¸ì„ ë‹¤ì‹œ í›ˆë ¨í•´ ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œ ì ìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.

```python
sc3 = SGDClassifier(loss="log_loss", max_iter=100, tol=None, random_state=42)
sc3.fit(train_scaled, train_target)
print(sc3.score(train_scaled, train_target))
print(sc3.score(test_scaled, test_target))

# ê²°ê³¼ 
0.957983193277311
0.925
```
