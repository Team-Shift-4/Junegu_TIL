# ì§€ë„í•™ìŠµ

## ë¨¸ì‹ ëŸ¬ë‹(2ì£¼ì°¨)

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

ë¨¸ì‹ ëŸ¬ë‹ì„ ì´ìš©í•´ ë„ë¯¸ì™€ ë¹™ì–´ë¥¼ êµ¬ë¶„í•˜ëŠ” ì˜ˆì œì´ë‹¤.\


#### ìƒì„  ë¶„ë¥˜ ë¬¸ì œë¥¼ í†µí•´ ë¨¸ì‹  ëŸ¬ë‹ì„ ì´í•´ í•´ë³´ì!

ğŸ¤¨ ì¤‘ìš”í•œ ì½”ë“œë§Œì„ ìœ„ì£¼ë¡œ ë‹¤ë£¹ë‹ˆë‹¤.



ì´ ì˜ˆì œì—ì„œëŠ” ë¨¼ì € ë„ë¯¸ ë°ì´í„°(length, weight)ì™€ ë¹™ì–´ ë°ì´í„°(length, weight)ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“­ë‹ˆë‹¤.

```python
# ë„ë¯¸ì˜ ê¸¸ì´(cm)ì™€ ë¬´ê²Œ(g)ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë‚˜íƒ€ëƒ„
bream_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0,
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0,
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0]
bream_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0,
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0]
```

```python
# ë¹™ì–´ì˜ ê¸¸ì´(cm)ì™€ ë¬´ê²Œ(g)ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë‚˜íƒ€ëƒ„
smelt_length = [9.8, 10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
smelt_weight = [6.7, 7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

```python
# ë¹™ì–´ì™€ ë„ë¯¸ì˜ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ë¥¼ í•©ì¹œë‹¤.
length = bream_length + smelt_length
weight = bream_weight + smelt_weight
```

ìœ„ ì½”ë“œì—ì„œëŠ” ë„ë¯¸ì™€ ë¹™ì–´ì˜ ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ í•©ì³ì„œ ê°ê°ì„ lengthì™€ weightë¼ëŠ” ë³€ìˆ˜ì— ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ ì±…ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ íŒ¨í‚¤ì§€ì¸ ì‚¬ì´í‚·ëŸ°ì„ ì‚¬ìš©í•˜ë ¤ë©´, ê° íŠ¹ì„±ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì„¸ë¡œ ë°©í–¥ìœ¼ë¡œ ëŠ˜ì–´ëœ¨ë¦° 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.



#### ê·¸ë ‡ë‹¤ë©´ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?



## zip() ë©”ì†Œë“œ ì´í•´í•˜ê¸°

* íŒŒì´ì¬ì˜ ë‚´ì¥ í•¨ìˆ˜ zip()ì€ iterable, ì¦‰ ìˆœíšŒ ê°€ëŠ¥í•œ ê°ì²´ë¥¼ ì¸ìë¡œ ë°›ê³  ê° ìë£Œí˜•ì˜ ê°ê°ì˜ ìš”ì†Œë¥¼ ë‚˜ëˆˆ í›„ ì¸ë±ìŠ¤ë¼ë¦¬ ì˜ë¼ì„œ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•´ì¤ë‹ˆë‹¤.
* ì—¬ê¸°ì„œ ë§í•˜ëŠ” iterable ìë£Œí˜•ì€ íŒŒì´ì¬ì—ì„œ ë¦¬ìŠ¤íŠ¸, íŠœí”Œ ê°™ì€ ë°˜ë³µ ê°€ëŠ¥í•œ ìë£Œí˜•ì„ ì˜ë¯¸ í•©ë‹ˆë‹¤.

ğŸ˜œ **ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ ì˜ˆì‹œë¥¼ ì‚´í´ ë³´ê² ìŠµë‹ˆë‹¤.**

```python
list1 = [1, 2, 3, 4]
list2 = ['ê°€ìŠ´', 'íŒ”', 'ì–´ê¹¨', 'ë“±']

for x, y in zip(list1, list2) :
  print(x,y)
```

ìœ„ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ìƒì„± ì‹œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.

```python
1 ê°€ìŠ´
2 íŒ”
3 ì–´ê¹¨
4 ë“±
```

ì¦‰, ì´ëŸ° ì‹ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì›ì†Œë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ zip()ë©”ì†Œë“œ ì…ë‹ˆë‹¤.

```python
# zipí•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°
fish_data = [[l,w] for l,w in zip(length, weight)]
```

\


ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ìƒì„ ì˜ ê¸¸ì´ì™€ ë¬´ê²Œë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

ê·¸ í›„ ì •ë‹µ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤. ì»´í“¨í„° í”„ë¡œê·¸ë¨ì€ ë¬¸ìë¥¼ ì§ì ‘ ì´í•´í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— 0ê³¼ 1ë¡œ í‘œí˜„í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. **ë„ë¯¸ì™€ ë¹™ì–´ê°€ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´ ë˜ë¯€ë¡œ 1ì´ 35ë²ˆ ë“±ì¥í•˜ê³ , 0ì´ 14ë²ˆ ë“±ì¥í•˜ëŠ” ë¦¬ìŠ¤íŠ¸**ë¥¼ ë§Œë“¤ì–´ ì£¼ë©´ ë©ë‹ˆë‹¤.

```python
fish_target = [1] * 35 + [0] * 14
print(fish_target)
```

\
ì´ì œ ì‚¬ì´í‚·ëŸ° íŒ¨í‚¤ì§€ì—ì„œ k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ê¸° ìœ„í•´ì„œ KNeighborsClassifierë¥¼ ì„í¬íŠ¸í•©ë‹ˆë‹¤. ë˜í•œ fit() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ì–´ì§„ ë°ì´í„°ë¡œ ì•Œê³ ë¦¬ì¦˜ì„ í›ˆë ¨í•˜ê³ , score() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì–¼ë§ˆë‚˜ ì˜ í›ˆë ¨ë˜ì—ˆëŠ”ì§€ í‰ê°€ë¥¼ í•´ë´…ë‹ˆë‹¤.

```python
# ì‚¬ì´í‚·ëŸ° ì„í¬íŠ¸ -> k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
from sklearn.neighbors import KNeighborsClassifier
# ê°ì²´ ìƒì„±
kn = KNeighborsClassifier()
# fit ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì£¼ì–´ì§„ ë°ì´í„°ë¡œ ì•Œê³ ë¦¬ì¦˜ í›ˆë ¨
kn.fit(fish_data, fish_target)

# ìŠ¤ì½”ì–´ ë©”ì†Œë“œëŠ” k ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì •í™•ë„ë¥¼ ì¸¡ì •í•˜ê¸°ìœ„í•œ ë©”ì†Œë“œì´ë‹¤.
kn.score(fish_data,fish_target)
```

\


ì´ì œ ë§Œë“  í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•´ ë´…ì‹œë‹¤. ì—¬ê¸°ì—ì„œ ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ì€ **k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì–´ë–¤ ë°ì´í„°ì— ëŒ€í•œ ë‹µì„ êµ¬í•  ë•Œ ì£¼ìœ„ì˜ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ë³´ê³  ë‹¤ìˆ˜ë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒì„ ì •ë‹µìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.**

ê·¸ë ‡ë‹¤ë©´ **ê¸¸ì´ê°€ 30, ë¬´ê²Œê°€ 600 ì¸ ìƒì„ ì„ í”„ë¡œê·¸ë¨ì— ë„£ê³  predict()ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡**í•´ë´…ì‹œë‹¤.

```python
# ì„ì˜ì˜ ê°’ì„ ë„£ì–´ í•´ë‹¹ ê¸¸ì´ì™€ í¬ê¸°ë¥¼ ê°€ì§„ ë¬¼ê³ ê¸°ê°€ ë„ë¯¸ì¸ì§€ íŒë‹¨
# ì¦‰, predict() ë©”ì†Œë“œëŠ” ìƒˆë¡œìš´ë°ì´í„°ì˜ ì •ë‹µì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
kn.predict([[30,600]])
# predict ë˜í•œ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ê°’ì„ ì „ë‹¬í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê´„í˜¸ë¥¼ ë‘ë²ˆ ê°ì‹¼ í˜•íƒœì´ë‹¤.
```

```python
# ê²°ê³¼
array([1])
```

ê²°ê³¼ë¡œ ë³´ì•˜ì„ ë•Œ ê¸¸ì´ 30, ë¬´ê²Œ 600ì¸ ìƒì„ ì€ ë„ë¯¸ë¼ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤.

\


## 2ì£¼ì°¨ 2ë²ˆì§¸ ìˆ˜ì—…

* ìœ„ ì‹¤ìŠµì˜ ë¬¸ì œì 
  * **ë¬¸ì œì™€ ì •ë‹µì„ ì „ë¶€ ì•Œë ¤ì£¼ê³  ì‹œí—˜**ì„ ì¹˜ëŠ” ë°©ë²•
  * í‰ê°€ë¥¼ ì œëŒ€ë¡œ í•˜ë ¤ë©´ **í›ˆë ¨ ë°ì´í„°**ì™€ **í‰ê°€ì— ì‚¬ìš©í•  ë°ì´í„°**ê°€ ê°ê° **ë‹¬ë¼ì•¼ í•¨**

\


ì´ë ‡ê²Œ í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ í‰ê°€ë¥¼ ìœ„í•´ **ë˜ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ê±°ë‚˜** ì´ë¯¸ **ì¤€ë¹„ëœ ë°ì´í„° ì¤‘ ì¼ë¶€ë¥¼ ë–¼ì–´ ë‚´ì–´ í™œìš©í•˜ëŠ” ë°©ë²•**ì…ë‹ˆë‹¤.

\


ë¨¼ì €, ì €ë²ˆê³¼ ê°™ì´ ë„ë¯¸ì™€ ë¹™ì–´ ë°ì´í„°ë¥¼ í•˜ë‚˜ë¡œ í•©ì¹œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“ ë‹¤.

```jsx
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0, 
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0, 
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 
                10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0, 
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0, 
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7, 
                7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

```jsx
fish_data = [[l, w] for l,w in zip(fish_length, fish_weight)] # zipì„ ì‚¬ìš©í•´ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸° 
fish_target = [1]*35 + [0] * 14 #ì´ ë°ì´í„°ì˜ ì²˜ìŒ 5ê°œëŠ” í›ˆë ¨ ì„¸íŠ¸ë¡œ, ë‚˜ë¨¸ì§€ 14ê°œëŠ” í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ì‚¬ìš© 
```

ê·¸ í›„, í›ˆë ¨ ë°ì´í„° ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë¶„ë¥˜í•´ì¤€ë‹¤.

```jsx
train_input = fish_data[:35]

train_target = fish_target[:35]

test_input = fish_data[35:]

test_target = fish_target[35:]
```

ê·¸ í›„, ê²°ê³¼ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ì˜€ëŠ”ë°, 0ì´ ë‚˜ì™”ë‹¤ ì™œ ê·¸ëŸ´ê¹Œ?

```jsx
kn.fit(train_input, train_target)
kn.score(test_input, test_target) # ë¬¸ì œì  -> ë§ˆì§€ë§‰ 14ê°œë¥¼ í…ŒìŠ¤íŠ¸ë¡œ ë–¼ì–´ ë†“ìœ¼ë©´ í›ˆë ¨ì„¸íŠ¸ì—ëŠ” ë¹™ì–´ê°€ í•œ ë§ˆë¦¬ë„ ì—†ìœ¼ë¯€ë¡œ ë¹™ì–´ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ì—†ìŒ ì´ëŸ¬í•œ í˜„ìƒì„ ìƒ˜í”Œë§ í¸í–¥ì´ë¼ê³  í•œë‹¤.
# ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ í›ˆë ¨ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ë„ë¯¸ì™€ ë¹™ì–´ë¥¼ ê³¨ê³ ë£¨ ì„ì–´ì•¼í•¨ 
```

```jsx
# ê²°ê³¼
0.0
```

ê·¸ ì´ìœ ëŠ” ë§ˆì§€ë§‰ 14ê°œë¥¼ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë–¼ì–´ ë†“ìœ¼ë©´, í›ˆë ¨ ì„¸íŠ¸ì—ëŠ” ë¹™ì–´ê°€ í•œ ë§ˆë¦¬ë„ ì—†ìœ¼ë¯€ë¡œ, ë§Œë“¤ì–´ì§„ í”„ë¡œê·¸ë¨ì€ ë¹™ì–´ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ê³¨ê³ ë£¨ ì„ì–´ ì£¼ì–´ì•¼ í•œë‹¤. ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ ìƒ˜í”Œë§ í¸í–¥ì´ë¼ê³  ë¶€ë¥¸ë‹¤.

\


#### ìƒ˜í”Œë§ í¸í–¥ì´ë€?

> **ëª¨ë¸ì´ í•™ìŠµí•˜ëŠ” ë°ì´í„°ê°€ ì „ì²´ ë°ì´í„°ì˜ ëŒ€í‘œì„±ì„ ì˜ ë°˜ì˜í•˜ì§€ ëª»í•˜ê³  íŠ¹ì • ë¶€ë¶„ì— ì¹˜ìš°ì³ì ¸ ìˆëŠ” ê²ƒ**

\


ì´ ì±…ì—ì„ , **ë„˜íŒŒì´ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œë§ í¸í–¥ì„ í•´ê²°**í•œë‹¤.

í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ê³¨ê³ ë£¨ ì„ê¸° ìœ„í•´ì„œ **ë„˜íŒŒì´ ë°°ì—´ë¥¼ ì‚¬ìš©í•´ ì¸ë±ìŠ¤ë¥¼ ì„ëŠ”ë‹¤.**

```jsx
import numpy as np

input_arr = np.array(fish_data)
target_arr = np.array(fish_target)
```

```jsx
np.random.seed(42) # ì¼ì •í•œ ê²°ê³¼ë¥¼ ì–»ìœ¼ë ¤ë©´ ì‹œë“œ ì„¤ì • í•„ìˆ˜
index = np.arange(49) # í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì™€ í›ˆë ¨ì„¸íŠ¸ë¥¼ ì„ê¸° ìœ„í—¤ arangeí•¨ìˆ˜ ì‚¬ìš© 
np.random.shuffle(index) # ì¸ë±ìŠ¤ ì„ê¸°
print(index)
```

ì¸ë±ìŠ¤ë¥¼ ì„ì€ í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ë©´ ì˜ ì„ì¸ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

```jsx
train_input = input_arr[index[:35]] # í›ˆë ¨ ì„¸íŠ¸ 
train_target = target_arr[index[:35]]
```

```jsx
test_input = input_arr[index[35:]] # í…ŒìŠ¤íŠ¸ ì„¸íŠ¸
test_target = target_arr[index[35:]]
```

```jsx
import matplotlib.pyplot as plt
plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(test_input[:,0], test_input[:,1])
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/2-1.png" alt=""><figcaption></figcaption></figure>

ê·¸ í›„, í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë„£ì–´ ëª¨ë¸ì„ í…ŒìŠ¤íŠ¸ í•´ ë³´ë©´ ì •ìƒì ì¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œ ëœë‹¤.

```jsx
kn.fit(train_input, train_target) # í›ˆë ¨ë°ì´í„°ë¡œ í›ˆë ¨ì‹œí‚´
kn.score(test_input,test_target) # í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë„£ì–´ ëª¨ë¸ í…ŒìŠ¤íŠ¸
```

```jsx
# ê²°ê³¼
1.0
```

```python
kn.predict(test_input) # ì˜ˆì¸¡ë°ì´í„°
# ê²°ê³¼
# array([0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0])
```

```python
print(test_target) # ì •ë‹µë°ì´í„°
# ê²°ê³¼ 
# [0 0 1 0 1 1 1 0 1 1 0 1 1 0]
```

```python
kn.predict([[30, 600]])
# ê²°ê³¼
# array([1])
```
