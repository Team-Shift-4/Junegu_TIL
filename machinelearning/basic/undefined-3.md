# ì„ í˜•/ë‹¤ì¤‘íšŒê·€

## ë¨¸ì‹ ëŸ¬ë‹(4ì£¼ì°¨)

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

ê¸¸ì´ê°€ 50cmì¸ ë†ì–´ì˜ ì˜ˆì¸¡ ë°ì´í„°ì™€ ì‹¤ì œ ë¬´ê²Œì˜ ì°¨ì´ê°€ í¬ë‹¤ ì™œ ê·¸ëŸ´ê¹Œ?

### ì˜ˆì¸¡ ë°ì´í„°ì™€ ì‹¤ì œ ë¬´ê²Œì˜ ê°„ê·¹ì˜ ì›ì¸ì„ ì°¾ì•„ë³´ì

ë¨¼ì €, ì•ì„œ ì‚¬ìš©í•œ ë°ì´í„°ì™€ ëª¨ë¸ì„ ì¤€ë¹„í•œë‹¤

```python
import numpy as np

perch_length = np.array([8.4, 13.7, 15.0, 16.2, 17.4, 18.0, 18.7, 19.0, 19.6, 20.0, 21.0,
       21.0, 21.0, 21.3, 22.0, 22.0, 22.0, 22.0, 22.0, 22.5, 22.5, 22.7,
       23.0, 23.5, 24.0, 24.0, 24.6, 25.0, 25.6, 26.5, 27.3, 27.5, 27.5,
       27.5, 28.0, 28.7, 30.0, 32.8, 34.5, 35.0, 36.5, 36.0, 37.0, 37.0,
       39.0, 39.0, 39.0, 40.0, 40.0, 40.0, 40.0, 42.0, 43.0, 43.0, 43.5,
       44.0])
perch_weight = np.array([5.9, 32.0, 40.0, 51.5, 70.0, 100.0, 78.0, 80.0, 85.0, 85.0, 110.0,
       115.0, 125.0, 130.0, 120.0, 120.0, 130.0, 135.0, 110.0, 130.0,
       150.0, 145.0, 150.0, 170.0, 225.0, 145.0, 188.0, 180.0, 197.0,
       218.0, 300.0, 260.0, 265.0, 250.0, 250.0, 300.0, 320.0, 514.0,
       556.0, 840.0, 685.0, 700.0, 700.0, 690.0, 900.0, 650.0, 820.0,
       850.0, 900.0, 1015.0, 820.0, 1100.0, 1000.0, 1100.0, 1000.0,
       1000.0])
from sklearn.model_selection import train_test_split
# í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆˆë‹¤.
train_input, test_input, train_target, test_target = train_test_split(
    perch_length, perch_weight, random_state=42)

# í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ 2ì°¨ì› ë°°ì—´ë¡œ ë°”ê¾¼ë‹¤.
train_input = train_input.reshape(-1,1)
test_input = test_input.reshape(-1,1)

print(train_input.shape, test_input.shape)
```

ìœ„, ì½”ë“œ ê¹Œì§„ ì´ì „ ì¥ê³¼ ë™ì¼í•˜ë‹¤.

ì´ì œ ì´ ëª¨ë¸ì„ ì‚¬ìš©í•´ ê¸¸ì´ê°€ 50cmì¸ ë†ì–´ì˜ ë¬´ê²Œë¥¼ **predictí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡**í•´ë³´ì.

```python
from sklearn.neighbors import KNeighborsRegressor

knr = KNeighborsRegressor(n_neighbors = 3)

knr.fit(train_input, train_target)
print(knr.score(train_input, train_target))
print(knr.score(test_input, test_target))

# ê²°ê³¼ 
0.9804899950518966
0.9746459963987609
print(knr.predict([[50]]))

# ê²°ê³¼ 
[1033.33333333]
```

ì‹¤ì œ ìœ„ ê²°ê³¼ì¸ 1033.33333333ë³´ë‹¤ ì‹¤ì œ ë†ì–´ëŠ” í›¨ì”¬ ë” ë§ì´ ë‚˜ê°„ë‹¤ê³  í•œë‹¤. ì–´ë””ì„œ ë¬¸ì œê°€ ìƒê¸´ê±¸ê¹Œ? í›ˆë ¨ ì„¸íŠ¸ì™€ 50cm ë†ì–´ ê·¸ë¦¬ê³  ì´ ë†ì–´ì˜ ìµœê·¼ì ‘ ì´ì›ƒì„ ì‚°ì ë„ì— í‘œì‹œí•´ë³´ì. ì• ì¥ì—ì„œ ë³´ì•˜ë“¯, ì‚¬ì´í‚·ëŸ°ì˜ k-ìµœê·¼ì ‘ ì´ì›ƒ ëª¨ë¸ì˜ kneighbors() ë©”ì„œë“œë¥¼ ì´ìš©í•˜ë©´ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒê¹Œì§€ì˜ ê±°ë¦¬ì™€ ì´ì›ƒ ìƒ˜í”Œì˜ ì¸ë±ìŠ¤ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.

```python
import matplotlib.pyplot as plt
# 50cm ë†ì–´ì˜ ì´ì›ƒì„ êµ¬í•œë‹¤.
distance, indexes = knr.kneighbors([[50]])
# í›ˆë ¨ ì„¸íŠ¸ì˜ ì‚°ì ë„ë¥¼ ê·¸ë¦°ë‹¤.
plt.scatter(train_input, train_target)
# í›ˆë ¨ ì„¸íŠ¸ ì¤‘ì—ì„œ ì´ì›ƒ ìƒ˜í”Œë§Œ ë‹¤ì‹œ ê·¸ë¦¼ 
plt.scatter(train_input[indexes], train_target[indexes], marker="D")

# 50cm ë†ì–´ ë°ì´í„° 
plt.scatter(50, 1033, marker="^")
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/4-2.png" alt=""><figcaption></figcaption></figure>

ê¸¸ì´ê°€ 50cmì´ê³  ë¬´ê²Œê°€ 1033gì¸ ë†ì–´ëŠ” ì„¸ëª¨ë¡œ í‘œì‹œë˜ëŠ”ë°, ê·¸ì— ê°€ì¥ ê°€ê¹Œìš´ ì£¼ë³€ ìƒ˜í”Œì€ ì‚¬ê°í˜•ìœ¼ë¡œ í‘œì‹œëœë‹¤. ê·¸ë˜í”„ë¥¼ ì˜ ì‚´í´ë³´ë©´ ë¬¸ì œë¥¼ ì•Œ ìˆ˜ ìˆë‹¤. ì–´ë–¤ ì ì´ ë¬¸ì œì¸ê°€? **ìš°ë¦¬ëŠ” í˜„ì¬ k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ê·¼ì ‘í•œ ì´ì›ƒì˜ ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ ê°’ì„ ì˜ˆì¸¡í•˜ê³  ìˆë‹¤. 50cm ë†ì–´ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê²ƒì€ 45cm ê·¼ë°©ì´ê¸° ë•Œë¬¸ì— ê·¸ì— ê¸°ë°˜í•˜ì—¬ ë¬´ê²Œë¥¼ í‰ê· í•´ 1033ì´ë¼ëŠ” ë¬´ê²Œë¥¼ ë„ì¶œí•´ ë‚¸ ê²ƒ** ì´ì˜€ë‹¤.

ì´ì›ƒ ìƒ˜í”Œ íƒ€ê²Ÿì˜ í‰ê· ì„ í•œë²ˆ êµ¬í•´ë³´ì.

```python
# ì´ì›ƒ ìƒ˜í”Œ íƒ€ê²Ÿì˜ í‰ê· 
print(np.mean(train_target[indexes]))
# ê²°ê³¼ 
1033.33333333
print(knr.predict([[100]]))
# ê²°ê³¼ 
1033.33333333
# 100cm ì¸ ë†ì–´ë¥¼ ì˜ˆì¸¡í•´ë„ ë˜‘ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
# ì´ìœ ëŠ” k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ì— ê¸°ë°˜í•˜ì—¬ ê°’ì„ ì˜ˆì¸¡í•˜ê¸° ë•Œë¬¸ì— ë” í° ìˆ«ìë¥¼ ë„£ë”ë¼ê³  ê²°ê³¼ëŠ” ë˜‘ê°™ì´ ì˜ˆì¸¡ ë  ê²ƒì´ë‹¤.
```

í•œë²ˆ ë” ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ì„œ í™•ì¸ í•´ë³´ì

```
distance, indexes = knr.kneighbors([[100]])

plt.scatter(train_input, train_target)
plt.scatter(train_input[indexes], train_target[indexes], marker="D")
plt.scatter(100,1033,marker="^")

plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/4-3.png" alt=""><figcaption></figcaption></figure>

```python
# í•™ìŠµì— ì‚¬ìš©ëœ ë†ì–´ ë°ì´í„°ì˜ ìµœëŒ€ ê°’ì´ 44cm
print(np.min(train_input), np.max(train_input))
# ê²°ê³¼ 
13.7 44.0
```

í•™ìŠµ ë°ì´í„°ë³´ë‹¤ í° ë°ì´í„°ë¥¼ ì˜ˆì¸¡ í–ˆì„ ë•Œ ì—­ì‹œ ëª¨ë‘ ê°™ì€ ì´ì›ƒ ë°ì´í„°ë¼ ê²°ê³¼ê°€ ë˜‘ê°™ì´ ë‚˜ì˜¨ë‹¤.

```python
distance, indexes = knr.kneighbors([[44]])
print(np.mean(train_target[indexes]), indexes)

distance, indexes = knr.kneighbors([[50]])
print(np.mean(train_target[indexes]), indexes)

distance, indexes = knr.kneighbors([[100]])
print(np.mean(train_target[indexes]), indexes)

# ê²°ê³¼ 
# í˜„ì¬ ì•„ë˜ ê²°ê³¼ëŠ” ê¸¸ì´ ë³„ë¡œ ì˜ˆì¸¡í•œ ë¬´ê²Œë¥¼ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤.
1033.3333333333333 [[34  8 14]]
1033.3333333333333 [[34  8 14]]
1033.3333333333333 [[34  8 14]]

# ê¸¸ì´ì— ë”°ë¼ ë¬´ê²Œë„ ì¦ê°€í•˜ëŠ” ê·¸ë˜í”„ ì¶”ì„¸ì´ì§€ë§Œ 44cm ì´ìƒì€ í•­ìƒ ë™ì¼í•œ ë¬´ê²Œë¡œ ì˜ˆì¸¡í•œë‹¤.
# k-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ì˜ ë¬¸ì œì 
```

ì´ëŸ° ì‹ì´ë©´ ë†ì–´ê°€ ì•„ë¬´ë¦¬ ì»¤ë„ ë¬´ê²Œê°€ ë” ì´ìƒ ëŠ˜ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. í•´ê²°ì±…ìœ¼ë¡œëŠ” ì–´ë–¤ ê²ƒì´ ìˆì„ê¹Œ?

### ì„ í˜•íšŒê·€ë€?

> ì„ í˜•íšŒê·€ë€ **ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ ëŒ€ë³€í•˜ëŠ” ìµœì ì˜ ì„ ì„ ì°¾ì€ ê³¼ì •**ì´ë‹¤.

* íŠ¹ì„±ì´ ë§ì„ìˆ˜ë¡ ìš°ìˆ˜í•œ íš¨ê³¼ë¥¼ ë‚´ëŠ”ê²Œ ì¼ë°˜ì ì´ë‹¤.

ì‚¬ì´í‚·ëŸ°ì€ sklearn.linear\_model íŒ¨í‚¤ì§€ ì•„ë˜ì— LinearRegression í´ë˜ìŠ¤ë¡œ ì„ í˜• íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì´ êµ¬í˜„ë˜ì–´ ìˆë‹¤. ì´ë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•´ ë³´ì.

### LinearRegressionë¥¼ ì‚¬ìš©í•´ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì

```python
from sklearn.linear_model import LinearRegression

lr = LinearRegression()

lr.fit(train_input, train_target)

print(lr.predict([[50]]))

# ê²°ê³¼
[1241.83860323]
```

k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì˜ˆì¸¡ í–ˆì„ ë•Œ ë³´ë‹¤ í›¨ì”¬ ë” ì˜ ì˜ˆì¸¡í–ˆë‹¤. ì„ í˜•íšŒê·€ê°€ í•™ìŠµí•œ ì§ì„ ì„ ê·¸ë ¤ë³´ê³  ì–´ë–»ê²Œ ì´ëŸ° ê°’ì´ ë‚˜ì™”ëŠ”ì§€ ì•Œì•„ë³´ì.

ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ì§ì„ ì„ ê·¸ë¦¬ë ¤ë©´ ê¸°ìš¸ê¸°ì™€ ì ˆí¸ì´ ìˆì–´ì•¼ í•œë‹¤. y = ax + b ì²˜ëŸ¼ ì“°ë©°, ì—¬ê¸°ì—ì„œ xë¥¼ ë†ì–´ì˜ ê¸¸ì´, yë¥¼ ë†ì–´ì˜ ë¬´ê²Œë¡œ ë°”ê¾¸ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

<figure><img src="../../.gitbook/assets/4-4.png" alt=""><figcaption></figcaption></figure>

ì—¬ê¸°ì„œ ê¸°ìš¸ê¸° **aì™€ ì ˆí¸ bëŠ” LinearRegression í´ë˜ìŠ¤ì˜ lrê°ì²´ì— coef\_(ê¸°ìš¸ê¸°)ì™€ intercept\_(ì ˆí¸) ì†ì„±**ì— ì €ì¥ë˜ì–´ ìˆë‹¤.

```python
# ìœ„ ë¬¸ì œì˜ ê¸°ìš¸ê¸°ì™€ ì ˆí¸
print(lr.coef_, lr.intercept_)

# ê²°ê³¼
[39.01714496] -709.0186449535477
```

ë†ì–´ì˜ ê¸¸ì´ 15ì—ì„œ 50ê¹Œì§€ ì§ì„ ìœ¼ë¡œ ê·¸ë ¤ë³´ì.

```python
# í›ˆë ¨ ì„¸íŠ¸ì˜ ì‚°ì ë„
plt.scatter(train_input, train_target)
# 15ì—ì„œ 50ê¹Œì§€ 1ì°¨ ë°©ì •ì‹ ê·¸ë˜í”„ 
plt.plot([15.50, 50], [15.50*lr.coef_+lr.intercept_, 50*lr.coef_+lr.intercept_])
# 50cm ë†ì–´ì˜ ë°ì´í„° 
plt.scatter(50, 1241.8, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/4-5.png" alt=""><figcaption></figcaption></figure>

ë°”ë¡œ **ì´ ì§ì„ ì´ ì„ í˜• íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì´ ì´ ë°ì´í„°ì…‹ ì—ì„œ ì°¾ì€ ìµœì ì˜ ì§ì„ ì´ë‹¤. ê¸¸ì´ê°€ 50cmì¸ ë†ì–´ ë˜í•œ ì§ì„ ì— ì—°ì¥ì„ ì— ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.** ì´ì œëŠ” í›ˆë ¨ ì„¸íŠ¸ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ë†ì–´ì˜ ë¬´ê²Œ ë˜í•œ ì˜ˆì¸¡ì´ ê°€ëŠ¥í•˜ë‹¤. ì´ì œ **í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ê²°ì • ê³„ìˆ˜**ë¥¼ í™•ì¸í•´ ë³´ì

```python
print(lr.score(train_input, train_target))
print(lr.score(test_input, test_target))

# ê²°ê³¼
0.939846333997604
0.8247503123313558
```

í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ì°¨ì´ê°€ ë‚œë‹¤. ì´ ëª¨ë¸ì€ ê³¼ëŒ€ì í•©ì¸ê°€? ì•„ë‹ˆë‹¤ ì˜¤íˆë ¤ ì „ì²´ì ìœ¼ë¡œ ê³¼ì†Œì í•© ë˜ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ë˜ ë‹¤ë¥¸ ë¬¸ì œê°€ ìˆë‹¤ ê·¸ë˜í”„ ì™¼ìª½ ì•„ë˜ë¥¼ ë‹¤ì‹œ í•œë²ˆ ì‚´í´ ë³´ì.

ìœ„ ê·¸ë˜í”„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ **ì™¼ìª½ ì•„ë˜ ë¶€ë¶„ì„ ë³´ë©´ ì•„ì£¼ ì‘ì€ ë†ì–´ì˜ ë¬´ê²Œê°€ 0ë³´ë‹¤ ì‘ì„ í™•ë¥ ì´ ìƒê¸´ë‹¤. ì„ í˜• íšŒê·€ ì§ì„ ì„ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆì¸¡í•  ë•Œ, ìƒì‹ì—ì„œ ë²—ì–´ë‚œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆë‹¤.**

### **ë‹¤í•­íšŒê·€ë€?**

> ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì„ í˜• ê´€ê³„ë¥¼ **ê³¡ì„ **ìœ¼ë¡œ ì„¤ëª…í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ì´ë©°, ì´ ë•Œ **2ì°¨ ì´ìƒì˜ ë‹¤í•­ í•¨ìˆ˜ë¥¼ ì‚¬ìš©**í•©ë‹ˆë‹¤. ë‹¤í•­íšŒê·€ëŠ” ì£¼ë¡œ ì„ í˜• íšŒê·€ ë§Œìœ¼ë¡œ ì„¤ëª… í•˜ì§€ ëª»í•  ë•Œ ì‚¬ìš©ëœë‹¤.

<figure><img src="../../.gitbook/assets/4-6.png" alt=""><figcaption></figcaption></figure>

ë‹¤í•­íšŒê·€ë¥¼ ì‚¬ìš©í•´ ìœ„ ëª¨ë¸ì„ ìˆ˜ì •í•˜ë ¤ë©´ ê¸¸ì´ë¥¼ ì œê³±í•œ í•­ì´ í›ˆë ¨ ì„¸íŠ¸ì— ì¶”ê°€ ë˜ì–´ì•¼ í•œë‹¤.

<figure><img src="../../.gitbook/assets/4-7.png" alt=""><figcaption></figcaption></figure>

ì• ì¥ì—ì„œ ì‚¬ìš©í•œ **column\_stack() í•¨ìˆ˜**ë¥¼ ì‚¬ìš©í•´ êµ¬í˜„í•´ë³´ì

```python
train_poly = np.column_stack((train_input ** 2, train_input))
test_poly = np.column_stack((test_input ** 2, test_input))

print(train_poly.shape, test_poly.shape)

# ê²°ê³¼
(42, 2) (14, 2)
```

ì›ë˜ **íŠ¹ì„±ì¸ ê¸¸ì´ë¥¼ ì œê³±í•˜ì—¬ ì™¼ìª½ ì—´ì— ì¶”ê°€í–ˆê¸° ë•Œë¬¸ì— í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ëª¨ë‘ ì—´ì´ 2ê°œë¡œ ëŠ˜ì–´ë‚¬ë‹¤.** ì´ì œ **train\_polyë¥¼ ì‚¬ìš©í•´ ì„ í˜• íšŒê·€ ëª¨ë¸ì„ ë‹¤ì‹œ í›ˆë ¨í•´ë³´ì.**

```python
lr2 = LinearRegression()

lr2.fit(train_poly, train_target)

print(lr2.predict([[50**2, 50]]))

# ê²°ê³¼ 
[1573.98423528]
```

ì• ì„ í˜•íšŒê·€ ëª¨ë¸ë³´ë‹¤ ë” ë†’ì€ ê°’ì„ ì˜ˆì¸¡í—€ë‹¤. ì´ë²ˆì—ëŠ” ì´ ëª¨ë¸ì˜ ê³„ìˆ˜ì™€ ì ˆí¸ì„ ì¶œë ¥í•´ë³´ì.

```python
print(lr2.coef_, lr2.intercept_)

# ê²°ê³¼ 
[  1.01433211 -21.55792498] 116.0502107827827
```

ê²°ê³¼ì ìœ¼ë¡œ, ì´ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ ê·¸ë˜í”„ë¥¼ í•™ìŠµí•˜ì˜€ë‹¤.

<figure><img src="../../.gitbook/assets/4-8.png" alt=""><figcaption></figcaption></figure>

ì´ì œ ì‚°ì ë„ë¥¼ í•œë²ˆ ê·¸ë ¤ë³´ì.

```python
# êµ¬ê°„ë³„ ì§ì„ ì„ ê·¸ë¦¬ê¸° ìœ„í•´ 15ì—ì„œ 49ê¹Œì§€ ì •ìˆ˜ ë°°ì—´ì„ ë§Œë“ ë‹¤.
point = np.arange(15, 50)
# í›ˆë ¨ ì„¸íŠ¸ì˜ ì‚°ì ë„ë¥¼ ê·¸ë¦°ë‹¤.
plt.scatter(train_input, train_target)
# 15ì—ì„œ 49ê¹Œì§€ì˜ 2ì°¨ ë°©ì •ì‹ì„ ê·¸ë¦°ë‹¤.
plt.plot(point, 1.01*point**2 - 21.6*point + 116.05)
# 50cm ë†ì–´ ë°ì´í„°
plt.scatter(50, 1574, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/4-9.png" alt=""><figcaption></figcaption></figure>

í›¨ì”¬ ë” ë‚˜ì€ ê·¸ë˜í”„ê°€ ê·¸ë ¤ì¡Œë‹¤. ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ê²°ì •ê³„ìˆ˜ë¥¼ í™•ì¸í•´ë³´ì.

```python
print(lr2.score(train_poly, train_target))
print(lr2.score(test_poly, test_target))

# ê²°ê³¼
0.9706807451768623
0.9775935108325122
```

í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ í¬ê²Œ ë†’ì•„ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ **ì•„ì§ ê³¼ì†Œ ì í•©ì´ ì¡°ê¸ˆ ë‚¨ì•„ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ë¯€ë¡œ ì¡°ê¸ˆ ë” ë³µì¡í•œ ëª¨ë¸ë¡œ ë§Œë“¤ í•„ìš”ê°€ ìˆì–´ ë³´ì¸ë‹¤.**

## 4ì£¼ì°¨ 2ë²ˆì§¸ ìˆ˜ì—…

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

í…ŒìŠ¤íŠ¸ ë°ì´í„°ì™€ í›ˆë ¨ ë°ì´í„°ë¥¼ ë¹„êµí•˜ì˜€ì„ ë•Œ ì—¬ì „íˆ ê³¼ì†Œì í•©ì´ ë°œìƒ

ğŸ˜„ **ì‚¬ì „ì— ì•Œê³  ê°€ë©´ ì¢‹ì€ ì§€ì‹**

* ë‹¤ì¤‘íšŒê·€ë€?

> ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ì¤‘íšŒê·€ë€ ì—¬ëŸ¬ ê°œì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•œ ì„ í˜•íšŒê·€ë¥¼ ë‹¤ì¤‘íšŒê·€ë¼ê³  í•œë‹¤.

<figure><img src="../../.gitbook/assets/4-1.png" alt=""><figcaption></figcaption></figure>

* íŠ¹ì„±ê³µí•™ì´ë€?

> ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ìœ„í•œ ë°ì´í„° í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì„ ìƒì„±í•˜ê±°ë‚˜ ì„ íƒí•˜ëŠ” ì‘ì—…ì„ ì˜ë¯¸í•œë‹¤ ì¦‰, ê¸°ì¡´ì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë½‘ì•„ë‚´ëŠ” ì‘ì—…ì´ë‹¤.

* ë‹¤ì–‘í•œ íŠ¹ì„± í™œìš© í•™ìŠµ
* ìš°ë¦¬ ì˜ˆì œì—ì„œëŠ” ë†ì–´ ê¸¸ì´, ë†’ì´, ë‘ê»˜ íŠ¹ì„± ì‚¬ìš©
* 3ê°œì˜ íŠ¹ì„±ì„ ê°ê° ì œê³± í•˜ì—¬ ì¶”ê°€
* ê° íŠ¹ì„±ì„ ì„œë¡œ ê³±í•´ì„œ ë˜ ë‹¤ë¥¸ íŠ¹ì„±ì„ ìƒì„±(ì˜ˆ : ë†ì–´ê¸¸ì´ X ë†ì–´ë†’ì´)

### ì¶”ê°€ì ì¸ íŠ¹ì„±ì„ ì‚¬ìš©í•´ ëª¨ë¸ì„ ë‹¤ì‹œ êµ¬í˜„í•˜ì!

ë¨¼ì €, ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ì. **íŒë‹¤ìŠ¤ë¥¼ ì‚¬ìš©í•´ ì¸í„°ë„·ì—ì„œ ë°ì´í„°í”„ë ˆì„ì„ ì €ì¥í•œ í›„ ë„˜íŒŒì´ ë°°ì—´ë¡œ ë³€í™˜í•˜ì—¬ ì„ í˜•íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨í•´ ë³´ì.**

```python
import pandas as pd
df = pd.read_csv('https://bit.ly/perch_csv')
perch_full = df.to_numpy()
print(perch_full)

# ê²°ê³¼ 
[[ 8.4   2.11  1.41]
 [13.7   3.53  2.  ]
 [15.    3.82  2.43]
 [16.2   4.59  2.63]
 [17.4   4.59  2.94]
 ....
```

íƒ€ê²Ÿ ë°ì´í„°ëŠ” ì´ì „ê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì¤€ë¹„í•œë‹¤.

```python
import numpy as np

perch_weight = np.array([5.9, 32.0, 40.0, 51.5, 70.0, 100.0, 78.0, 80.0, 85.0, 85.0, 110.0,
       115.0, 125.0, 130.0, 120.0, 120.0, 130.0, 135.0, 110.0, 130.0,
       150.0, 145.0, 150.0, 170.0, 225.0, 145.0, 188.0, 180.0, 197.0,
       218.0, 300.0, 260.0, 265.0, 250.0, 250.0, 300.0, 320.0, 514.0,
       556.0, 840.0, 685.0, 700.0, 700.0, 690.0, 900.0, 650.0, 820.0,
       850.0, 900.0, 1015.0, 820.0, 1100.0, 1000.0, 1100.0, 1000.0,
       1000.0])
```

ê·¸ í›„ perch\_fullê³¼ perch\_weightë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆˆë‹¤.

```
from sklearn.model_selection import train_test_split

train_input, test_input, train_target, test_target = train_test_split(
    perch_full, perch_weight, random_state=42)

print(train_input.shape)
print(test_input.shape)
print(train_target.shape)
print(test_target.shape)

# ê²°ê³¼
(42, 3)
(14, 3)
(42,)
(14,)
```

ì´ì œ ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë§Œë“¤ì–´ë³´ì.

### ì‚¬ì´í‚·ëŸ° ë³€í™˜ê¸°

ì‚¬ì´í‚·ëŸ°ì€ íŠ¹ì„±ì„ ë§Œë“¤ê±°ë‚˜ ì „ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤. **ì‚¬ì´í‚·ëŸ°ì—ì„œëŠ” ì´ëŸ° í´ë˜ìŠ¤ë¥¼ ë³€í™˜ê¸°**ë¼ê³  í•œë‹¤. ë³€í™˜ê¸° í´ë˜ìŠ¤ì—ì„œëŠ” fit(), transform() ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.

ìš°ë¦¬ê°€ ì‚¬ìš©í•  ë³€í™˜ê¸°ëŠ” **PolynomialFeatures í´ë˜ìŠ¤ì´ë‹¤. ì´ í´ë˜ìŠ¤ëŠ” sklearn.preprocessing íŒ¨í‚¤ì§€ ì•ˆì— í¬í•¨ë˜ì–´ìˆë‹¤.**

ê°„ë‹¨í•˜ê²Œ ë³€í™˜ê¸° ì‹¤ìŠµì„ ì§„í–‰í•´ë³´ì.

```python
from sklearn.preprocessing import PolynomialFeatures

# defree=2
poly = PolynomialFeatures()
poly.fit([[2,3]])

# 1(bias), 2, 3, 2**2, 2*3, 3**2
print(poly.transform([[2,3]]))

# ê²°ê³¼
[[1. 2. 3. 4. 6. 9.]]
```

**PolynomialFeaturesí´ë˜ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê° íŠ¹ì„± ì œê³±ê°’ í•­ê³¼ íŠ¹ì„±ë¼ë¦¬ ê³±í•œê°’ í•­ì„ ì¶”ê°€. ì„ í˜• ë°©ì •ì‹ ì ˆí¸ ê°’ 1 ì¶”ê°€í•œë‹¤.**

```python
poly = PolynomialFeatures(include_bias=False)
poly.fit([[2,3]])
print(poly.transform([[2,3]]))
# ê²°ê³¼
[[2. 3. 4. 6. 9.]]
```

ë˜í•œ ìœ„ì™€ ê°™ì´ **include\_bias = False ì˜µì…˜**ìœ¼ë¡œ ì ˆí¸ í•­ì„ ì œê±° í•  ìˆ˜ ìˆë‹¤.

ì, ì´ì œ ë³€í™˜ê¸° ì‹¤ìŠµì„ ìš°ë¦¬ ì˜ˆì œì— ì ìš©í•´ë³´ì.

```python
poly = PolynomialFeatures(include_bias=False)
poly.fit(train_input)
train_poly = poly.transform(train_input)
print(train_poly.shape)
train_poly[:3]

# ê²°ê³¼
(42, 9)
array([[ 19.6   ,   5.14  ,   3.04  , 384.16  , 100.744 ,  59.584 ,
         26.4196,  15.6256,   9.2416],
       [ 22.    ,   5.88  ,   3.52  , 484.    , 129.36  ,  77.44  ,
         34.5744,  20.6976,  12.3904],
       [ 18.7   ,   5.2   ,   3.12  , 349.69  ,  97.24  ,  58.344 ,
         27.04  ,  16.224 ,   9.7344]])
         
# ê²°ê³¼ë¡œ ë³´ì•„ ê°œë³„íŠ¹ì„± ì œê³±ê°’ í•­ 3ê°œ
# ê°œë³„íŠ¹ì„± ê°„ ê³± í•­ 3ê°œ ì¶”ê°€
# ì´ 9ê°œ íŠ¹ì„±ì„ ê°€ì§„ë‹¤.
```

**9ê°œì˜ íŠ¹ì„±ì´ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì¡ŒëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ get\_feature\_names\_out() ë©”ì„œë“œ**ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```python
poly.get_feature_names_out()

# ê²°ê³¼
array(['x0', 'x1', 'x2', 'x0^2', 'x0 x1', 'x0 x2', 'x1^2', 'x1 x2',
       'x2^2'], dtype=object)
```

ì´ì œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ë³€í™˜í•˜ì.

```python
test_poly = poly.transform(test_input)
print(test_poly.shape)
test_poly[:3]

# ê²°ê³¼
(14, 9)
array([[  8.4   ,   2.11  ,   1.41  ,  70.56  ,  17.724 ,  11.844 ,
          4.4521,   2.9751,   1.9881],
       [ 18.    ,   5.22  ,   3.32  , 324.    ,  93.96  ,  59.76  ,
         27.2484,  17.3304,  11.0224],
       [ 27.5   ,   7.28  ,   4.57  , 756.25  , 200.2   , 125.675 ,
         52.9984,  33.2696,  20.8849]])
```

ê·¸ í›„ ì´ì–´ì„œ ë³€í™˜ëœ íŠ¹ì„±ì„ ì‚¬ìš©í•´ ë‹¤ì¤‘ íšŒê·€ ëª¨ë¸ì„ ë§Œë“¤ì–´ë³´ì.

```python
from sklearn.linear_model import LinearRegression

lr = LinearRegression()
lr.fit(train_poly, train_target)
print(lr.score(train_poly, train_target))

# ê²°ê³¼
0.9903183436982125
```

ì´ì–´ì„œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ëŒ€í•œ ì ìˆ˜ë„ í™•ì¸í•´ë³´ì.

```python
print(lr.score(test_poly, test_target))

# ê²°ê³¼
0.9714559911594111
```

í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ë†’ì–´ì§€ì§€ ì•Šì•˜ì§€ë§Œ ë†ì–´ì˜ ê¸¸ì´ë§Œì„ ì‚¬ìš©í–ˆì„ ë•Œ ìˆë˜ **ê³¼ì†Œì í•© ë¬¸ì œëŠ” í•´ê²°** ë˜ì—ˆë‹¤. íŠ¹ì„±ì„ ë” ë§ì´ ì¶”ê°€í•˜ë©´ ì–´ë–¨ê¹Œ? ì´ ì±…ì—ì„œëŠ” 5ì œê³± ê¹Œì§€ íŠ¹ì„±ì„ ë§Œë“¤ì–´ ì¶œë ¥í•´ ë³´ì•˜ë‹¤.

```python
poly = PolynomialFeatures(degree=5, include_bias=False)
poly.fit(train_input)
train_poly = poly.transform(train_input)
test_poly = poly.transform(test_input)
print(train_poly.shape, test_poly.shape)
# train_poly[:1]

# ê²°ê³¼ 
(42, 55) (14, 55)
```

ì—¬ê¸°ì„œ **train\_poly ë°°ì—´ì˜ ì—´ì˜ ê°œìˆ˜ê°€ íŠ¹ì„±ì˜ ê°œìˆ˜ì´ë¯€ë¡œ, ë§Œë“¤ì–´ì§„ íŠ¹ì„±ì˜ ê°œìˆ˜ê°€ 55ê°œ**ì´ë‹¤. ì´ì œ ëª¨ë¸ì„ ë‹¤ì‹œ í›ˆë ¨ì‹œì¼œë³´ì.

```python
lr.fit(train_poly, train_target)
print(lr.score(train_poly, train_target))
print(lr.score(test_poly, test_target))

# ê²°ê³¼ 
0.9999999999996433
-144.40579436844948
```

í›ˆë ¨ ì„¸íŠ¸ëŠ” ê±°ì˜ ì™„ë²½ì— ê°€ê¹Œìš´ ì ìˆ˜ì´ë‹¤. í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ëŠ” ì•„ì£¼ í° ìŒìˆ˜ê°€ ì¶œë ¥ ë˜ì—ˆë‹¤. ì–´ë–»ê²Œ ëœ ê²ƒì¼ê¹Œ? **íŠ¹ì„±ì˜ ê°œìˆ˜ë¥¼ í¬ê²Œ ëŠ˜ë¦¬ë©´ ì„ í˜• ëª¨ë¸ì€ ê°•ë ¥í•´ì§€ì§€ë§Œ ì´ëŸ° ëª¨ë¸ì€ í›ˆë ¨ ì„¸íŠ¸ì— ë„ˆë¬´ ê³¼ëŒ€ ì í•©ë˜ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œëŠ” í˜•í¸ì—†ëŠ” ì ìˆ˜ë¥¼ ë§Œë“ ë‹¤.**

ì›ì¸ì„ ì•Œì•˜ìœ¼ë¯€ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ íŠ¹ì„±ì„ ë‹¤ì‹œ ì¤„ì—¬ë³´ì.

### ê·œì œ

> ê·œì œë€ **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì´ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ë„ˆë¬´ ê³¼ë„í•˜ê²Œ í•™ìŠµí•˜ì§€ ëª»í•˜ë„ë¡ í›¼ë°©í•˜ëŠ” ê²ƒì„ ì˜ë¯¸**í•œë‹¤. ì¦‰, **ëª¨ë¸ì´ í›ˆë ¨ ì„¸íŠ¸ì— ê³¼ëŒ€ì í•©ë˜ì§€ ì•Šë„ë¡ ë§Œë“œëŠ” ê²ƒ**ì´ë‹¤.

* ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ ê²½ìš° íŠ¹ì„±ì— ê³±í•´ì§€ëŠ” ê³„ìˆ˜(ë˜ëŠ” ê¸°ìš¸ê¸°)ì˜ í¬ê¸°ë¥¼ ì‘ê²Œ ë§Œë“œëŠ” ê²ƒ

<figure><img src="../../.gitbook/assets/4-10 (1).png" alt=""><figcaption></figcaption></figure>

ì´ë²ˆì—ëŠ” ì‚¬ì´í‚·ëŸ°ì—ì„œ ì œê³µí•˜ëŠ” **StandardScaler í´ë˜ìŠ¤**ë¥¼ ì‚¬ìš©í•˜ì—¬ì„œ ë¬¸ì œë¥¼ í•´ê²° í•´ë³´ì. ê·œì œë¥¼ ì ìš©í•˜ê¸° ì „ íŠ¹ì„± ìŠ¤ì¼€ì¼ì„ ì •ê·œí™”í•˜ì.

```python
from sklearn.preprocessing import StandardScaler

ss = StandardScaler()
ss.fit(train_poly)
train_scaled = ss.transform(train_poly)
test_scaled = ss.transform(test_poly)

print(train_poly[:1])
print(train_scaled[:1])

# ê²°ê³¼
# 55ê°œì˜ íŠ¹ì„± ê°’ì„ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¥¼ ì´ìš©í•˜ì—¬ ì •ê·œí™”
[[1.96000000e+01 5.14000000e+00 3.04000000e+00 3.84160000e+02
  1.00744000e+02 5.95840000e+01 2.64196000e+01 1.56256000e+01
  9.24160000e+00 7.52953600e+03 1.97458240e+03 1.16784640e+03
  5.17824160e+02 3.06261760e+02 1.81135360e+02 1.35796744e+02
  8.03155840e+01 4.75018240e+01 2.80944640e+01 1.47578906e+05
  3.87018150e+04 2.28897894e+04 1.01493535e+04 6.00273050e+03
  3.55025306e+03 2.66161618e+03 1.57418545e+03 9.31035750e+02
  5.50651494e+02 6.97995264e+02 4.12822102e+02 2.44159375e+02
  1.44405545e+02 8.54071706e+01 2.89254655e+06 7.58555575e+05
  4.48639873e+05 1.98927329e+05 1.17653518e+05 6.95849599e+04
  5.21676772e+04 3.08540347e+04 1.82483007e+04 1.07927693e+04
  1.36807072e+04 8.09131319e+03 4.78552376e+03 2.83034868e+03
  1.67398054e+03 3.58769566e+03 2.12190560e+03 1.25497919e+03
  7.42244501e+02 4.38992857e+02 2.59637799e+02]]
[[-1.01339619 -1.01007487 -1.01952321 -0.9549757  -0.9496784  -0.95745849
  -0.93942079 -0.94342509 -0.94100107 -0.88757122 -0.88399964 -0.89100599
  -0.87785292 -0.88311456 -0.88430909 -0.8691891  -0.87259422 -0.87147928
  -0.86603533 -0.82233944 -0.82171953 -0.8280588  -0.81928269 -0.82512549
  -0.8278857  -0.81486775 -0.82006923 -0.82177279 -0.82010716 -0.80835934
  -0.81274154 -0.81321125 -0.8098514  -0.80275974 -0.7637909  -0.76597773
  -0.77150714 -0.76668667 -0.77246614 -0.77577893 -0.76571689 -0.77162398
  -0.77472752 -0.77517751 -0.76290623 -0.76877311 -0.77148634 -0.77113383
  -0.767785   -0.75814062 -0.76376113 -0.76586966 -0.76449499 -0.75967179
  -0.75143746]]
```

### ë¦¿ì§€ì™€ ë¼ì˜

* ë¦¿ì§€ì™€ ë¼ì˜ëŠ” ì„ í˜•íšŒê·€ ëª¨ë¸ì— ê·œì œë¥¼ ì¶”ê°€í•œ ê²ƒì´ë‹¤.
* ë‘ ëª¨ë¸ì€ ê·œì œë¥¼ ê°€í•˜ëŠ” ë°©ë²•ì—ì„œ ì°¨ì´ë¥¼ ë³´ì¸ë‹¤.
* ì¼ë°˜ì ìœ¼ë¡œëŠ” ë¦¿ì§€ë¥¼ ì¡°ê¸ˆ ë” ì„ í˜¸í•œë‹¤. (ë‘ ì•Œê³ ë¦¬ì¦˜ì€ **ë‘˜ ë‹¤ ê³„ìˆ˜ì˜ í¬ê¸°ë¥¼ ì¤„ì´ì§€ë§Œ ë¼ì˜ëŠ” ì•„ì˜ˆ 0ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ë‹¤**.)
* ë¦¿ì§€ì™€ ë¼ì˜ëŠ” ëª¨ë‘ sklearn.linear\_model íŒ¨í‚¤ì§€ ì•ˆì— ì¡´ì¬í•œë‹¤.

ë¦¿ì§€ì˜ ê²½ìš°

* ê³„ìˆ˜ë¥¼ ì œê³±í•œ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©
* L2 ê·œì œ

ë¼ì˜ì˜ ê²½ìš°

* ê³„ìˆ˜ì˜ ì ˆëŒ“ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©í•œë‹¤.
* L1ê·œì œ

ì•ì„œ ì¤€ë¹„í•œ **train\_scaled ë°ì´í„°ë¡œ ë¦¿ì§€ ëª¨ë¸ì„ í›ˆë ¨í•´ë³´ì.**

```python
from sklearn.linear_model import Ridge

print(train_scaled.shape, test_scaled.shape)

ridge = Ridge()
ridge.fit(train_scaled, train_target)
print(ridge.score(train_scaled, train_target))

# ê²°ê³¼
(42, 55) (14, 55)
0.9896101671037343
```

ì„ í˜• íšŒê·€ì—ì„œëŠ” ê±°ì˜ ì™„ë²½ì— ê°€ê¹Œì› ë˜ ì ìˆ˜ê°€ ì¡°ê¸ˆì€ ë‚®ì•„ì¡Œë‹¤. í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ í™•ì¸í•´ë³´ì.

```python
print(ridge.score(test_scaled, test_target))

# ê²°ê³¼
0.9790693977615387
```

í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ì •ìƒìœ¼ë¡œ ëŒì•„ì™”ë‹¤. ì¶”ê°€ì **ìœ¼ë¡œ ë¦¿ì§€ì™€ ë¼ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•  ë•Œ ê·œì œì˜ ì–‘ì„ ì„ì˜ë¡œ ì¡°ì ˆí•  ìˆ˜ë„ ìˆë‹¤. ëª¨ë¸ ê°ì²´ë¥¼ ë§Œë“¤ ë•Œ alpha ë§¤ê°œë³€ìˆ˜ë¡œ ê·œì œì˜ ê°•ë„ë¥¼ ì¡°ì ˆí•œë‹¤. alpha ê°’ì´ í¬ë©´ ê·œì œì˜ ê°•ë„ê°€ ì„¸ì§€ë¯€ë¡œ ê³„ìˆ˜ ê°’ì„ ì¤„ì´ê³  , ì¡°ê¸ˆ ë” ê³¼ì†Œì í•© ë˜ë„ë¡ ìœ ë„í•œë‹¤. alpha ê°’ì´ ì‘ìœ¼ë©´ ê³„ìˆ˜ë¥¼ ì¤„ì´ëŠ” ì—­í• ì´ ì¤„ì–´ë“¤ê³  ì„ í˜• íšŒê·€ ëª¨ë¸ê³¼ ìœ ì‚¬í•´ì§€ë¯€ë¡œ ê³¼ëŒ€ì í•©ë  ê°€ëŠ¥ì„±ì´ í¬ë‹¤.**

**ì ì ˆí•œ alpha ê°’ì„ ì°¾ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€ alpha ê°’ì— ëŒ€í•œ R^2(ê²°ì •ê³„ìˆ˜) ê°’ì˜ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ë³´ëŠ” ê²ƒ**ì´ë‹¤. **í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ê°’ì´ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì´ ìµœì ì˜ alphaê°’**ì´ ëœë‹¤.

```python
import matplotlib.pyplot as plt

train_score = []
test_score = []

alpha_list = [0.001, 0.01, 0.1, 1, 10, 100]
for alpha in alpha_list:
    ridge = Ridge(alpha=alpha)
    ridge.fit(train_scaled, train_target)
    train_score.append(ridge.score(train_scaled, train_target))
    test_score.append(ridge.score(test_scaled, test_target))

plt.plot(np.log10(alpha_list), train_score, label='Train Score')
plt.plot(np.log10(alpha_list), test_score, label='Test Score')
plt.xlabel('log10(alpha)')
plt.ylabel('R^2')
plt.legend()
plt.show()
```

<figure><img src="../../.gitbook/assets/4-11.png" alt=""><figcaption></figcaption></figure>

**ì´ ê·¸ë˜í”„ì—ì„œëŠ” ì ì ˆí•œ alpha ê°’ì´ -1 ì¦‰, 10ì— -1ìŠ¹ 0.1ì´ ëœë‹¤.**

ì´ì œ alphaê°’ì„ 0.1ë¡œ ë„£ê³  í›ˆë ¨í•´ë³´ì.

```python
ridge = Ridge(alpha=0.1)
ridge.fit(train_scaled, train_target)

print(ridge.score(train_scaled, train_target))
print(ridge.score(test_scaled, test_target))

# ê²°ê³¼
0.9903815817570367
0.9827976465386928
```

ì´ì œ ë¼ì˜ ëª¨ë¸ë¡œ í›ˆë ¨í•´ë³´ì. ë¼ì˜ ëª¨ë¸ì„ ì“°ëŠ”ë²•ì€ ê·¸ëƒ¥ Ridge í´ë˜ìŠ¤ë¥¼ Lasso í´ë˜ìŠ¤ë¡œ ë°”ê¾¸ëŠ” ê²ƒì´ ì „ë¶€ì´ë‹¤.

```python
from sklearn.linear_model import Lasso
lasso = Lasso()
lasso.fit(train_scaled, train_target)
print(lasso.score(train_scaled, train_target))

# ê²°ê³¼
0.989789897208096
```

ë¼ì˜ ë˜í•œ ê³¼ëŒ€ì í•©ì„ ì˜ ì–µì œí•œ ëª¨ìŠµì„ ë³´ì—¬ì¤€ë‹¤. í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì ìˆ˜ë„ í™•ì¸í•´ë³´ì.

```python
print(lasso.score(test_scaled, test_target))

# ê²°ê³¼
0.9800593698421883
```

í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë„ ë¦¿ì§€ë§Œí¼ ì•„ì£¼ ì¢‹ë‹¤. ë¼ì˜ ëª¨ë¸ë„ ì ì ˆí•œ alpha ê°’ì„ ì°¾ì•„ í›ˆë ¨í•´ë³´ì.

```python
import matplotlib.pyplot as plt

train_score2 = []
test_score2 = []

alpha_list = [0.001, 0.01, 0.1, 1, 10, 100]
for alpha in alpha_list:
    lasso = Lasso(alpha=alpha, max_iter=10000)
    lasso.fit(train_scaled, train_target)
    train_score2.append(lasso.score(train_scaled, train_target))
    test_score2.append(lasso.score(test_scaled, test_target))

plt.plot(np.log10(alpha_list), train_score2, label='Train Score')
plt.plot(np.log10(alpha_list), test_score2, label='Test Score')
plt.xlabel('log10(alpha)')
plt.ylabel('R^2')
plt.legend()
plt.show()
```

<figure><img src="../../.gitbook/assets/4-12.png" alt=""><figcaption></figcaption></figure>

**ë‘ ê·¸ë˜í”„ê°€ ê°€ì¥ ê°€ê¹ê³ ,í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ ê³³ ì´ ê·¸ë˜í”„ì—ì„œ ì ì ˆí•œ alpha ê°’ : 1, ì¦‰, 10ì— 1ìŠ¹ = 10 ì´ë‹¤.**

ì´ì œ ì´ ê°’ìœ¼ë¡œ ëª¨ë¸ì„ í›ˆë ¨ í•´ë³´ì.

```python
lasso = Lasso(alpha=10)
lasso.fit(train_scaled, train_target)

print(lasso.score(train_scaled, train_target))
print(lasso.score(test_scaled, test_target))

# ê²°ê³¼
0.9888067471131867
0.9824470598706695
```

ê²°ê³¼ì ìœ¼ë¡œ ëª¨ë¸ì´ ì˜ í›ˆë ¨ëœ ê²ƒ ê°™ë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ **ë¼ì˜ ëª¨ë¸ì€ ê³„ìˆ˜ ê°’ì„ ì•„ì˜ˆ 0ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤ê³  ì–¸ê¸‰**í–ˆì—ˆë‹¤. ë¼ì˜ ëª¨ë¸ì˜ ê³„ìˆ˜ëŠ” coef\_ ì†ì„±ì— ì €ì¥ë˜ì–´ ìˆë‹¤. ì´ ì¤‘ 0ì¸ ê²ƒì„ ì ì‹œ í—¤ì•„ë ¤ ë³´ì.

```python
print(np.sum(lasso.coef_ == 0))

# ê²°ê³¼ 
40
```

55ê°œì˜ íŠ¹ì„±ì¤‘ 40ê°œê°€ 0ì´ë‹¤. **ì´ ë§ì€ ì¦‰ìŠ¨, 15ê°œì˜ íŠ¹ì„±ë§Œ ì‚¬ìš© í–ˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ëŸ° íŠ¹ì§• ë–„ë¬¸ì— ë¼ì˜ ëª¨ë¸ì€ ìœ ìš©í•œ íŠ¹ì„±ì„ ê³¨ë¼ë‚´ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•œë‹¤.**

```python
print(lasso.coef_, lasso.intercept_)

# ê²°ê³¼
[ 0.          0.          0.         12.14852453 55.44856399 42.23100799
  0.          0.         13.70596191  0.         43.2185952   5.7033775
 47.46254536  7.42309425 11.85823365  0.          0.         13.53038193
 21.22111356  0.          0.          0.          0.          0.
  0.         18.66993032  0.          0.          0.         15.81041778
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.         18.14672268  0.          0.          0.
  0.         15.51272953  0.          0.          0.          0.
  0.        ] 400.8333333333333
```

ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹ ê·œ ë†ì–´ì˜ íŠ¹ì„±ì„ ì´ìš©í•œ ë¬´ê²Œ ì˜ˆì¸¡ ì‹¤ìŠµ

```python
new_fish = np.array([[44., 12.49, 7.6]])
print(new_fish)

new_fish_poly = poly.transform(new_fish)
new_fish_scaled = ss.transform(new_fish_poly)
print(new_fish_scaled.shape)
# í‰ê· ì¸ 0ì—ì„œ ë–¨ì–´ì§„ í‘œì¤€í¸ì°¨ì˜ ê°’
print(new_fish_scaled)

print(ridge.predict(new_fish_scaled))
print(lasso.predict(new_fish_scaled))

# ê²°ê³¼ 
[[44.   12.49  7.6 ]]
(1, 55)
[[1.78210426 1.54784238 1.59159052 2.00213235 1.84083371 1.8909844
  1.67749082 1.72136012 1.73751044 2.21667807 2.07967063 2.13832699
  1.93724544 1.99057995 2.02250988 1.79151358 1.8388309  1.86510712
  1.87017916 2.4256248  2.30167099 2.36893804 2.17068468 2.23426274
  2.27919017 2.03397399 2.09297248 2.13311848 2.1539982  1.89294536
  1.9465971  1.98129197 1.99650826 1.99214678 2.62713913 2.51236267
  2.58740194 2.38948507 2.46257683 2.51859    2.25940693 2.32955303
  2.3822465  2.41711267 2.12322455 2.18944335 2.23789418 2.26798098
  2.27936649 1.98222128 2.0436009  2.08698315 2.11159918 2.11702662
  2.10318333]]
[1082.38188249]
[1065.78722382]
```
