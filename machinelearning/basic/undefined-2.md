# ë¶„ë¥˜/íšŒê·€

## ë¨¸ì‹ ëŸ¬ë‹(3ì£¼ì°¨)

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

ê¸¸ì´ 25cm, ë¬´ê²Œ 150gì¸ ìƒì„ ì„ ë¹™ì–´ë¼ê³  ë³¼ ìˆ˜ ìˆëŠ”ê°€?

ğŸ˜„ **ì‚¬ì „ì— ì•Œê³  ê°€ì•¼ í•  ë‚´ì¥ í•¨ìˆ˜**

column\_stack()

> numpy.column\_stack() í•¨ìˆ˜ëŠ” NumPy ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•¨ìˆ˜ ì¤‘ í•˜ë‚˜ë¡œ, ì£¼ì–´ì§„ ë°°ì—´ë“¤ì„ ì—´ ë°©í–¥ìœ¼ë¡œ ìŒ“ì•„ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ìƒì„±í•œë‹¤.

```python
import numpy as np

list01 = [1,2,3]
list02 = [3,4,5]

np.column_stack((list01, list02))

// ê²°ê³¼ array([[1, 3],
              [2, 4],
              [3, 5]])
```

ones()í•¨ìˆ˜, zeros()í•¨ìˆ˜

> numpy.ones() í•¨ìˆ˜ì™€ numpy.zeros() í•¨ìˆ˜ëŠ” ê°ê° 1ë¡œ ì±„ì›Œì§„ ë°°ì—´ê³¼ 0ìœ¼ë¡œ ì±„ì›Œì§„ ë°°ì—´ì„ ìƒì„±í•˜ëŠ” NumPy í•¨ìˆ˜ì´ë‹¤. ì´ í•¨ìˆ˜ë“¤ì€ ì£¼ì–´ì§„ ëª¨ì–‘(shape)ì˜ ë°°ì—´ì„ ë§Œë“¤ê³ , ëª¨ë“  ìš”ì†Œë¥¼ íŠ¹ì • ê°’(1 ë˜ëŠ” 0)ìœ¼ë¡œ ì´ˆê¸°í™”í•œë‹¤

```python
one_list = np.ones(5)
zero_list = np.zeros(5)

print(one_list)
print(zero_list)

// ê²°ê³¼ [1. 1. 1. 1. 1.]
				[0. 0. 0. 0. 0.]
```

concatenateí•¨ìˆ˜

> numpy.concatenate() í•¨ìˆ˜ëŠ” NumPy ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µë˜ëŠ” ë°°ì—´ì„ ì—°ê²°(ê²°í•©)í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ë°°ì—´ì„ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ ê²°í•©í•  ìˆ˜ ìˆìœ¼ë©°. concatenate() í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ì¶•(axis)ì„ ê¸°ì¤€ìœ¼ë¡œ ë°°ì—´ì„ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.

```python
np.concatenate((one_list,zero_list))

// ê²°ê³¼ array([1., 1., 1., 1., 1., 0., 0., 0., 0., 0.])
```

train\_test\_split()í•¨ìˆ˜

> train\_test\_split() í•¨ìˆ˜ëŠ” ì‚¬ì´í‚·ëŸ°(Scikit-learn) ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µë˜ëŠ” í•¨ìˆ˜ë¡œ, ë°ì´í„°ì…‹ì„ í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ë¬´ì‘ìœ„ë¡œ ë¶„í• í•˜ëŠ” ì—­í• ì„ í•˜ë©°, ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ ë°ì´í„°ë¥¼ í›ˆë ¨ì— ì‚¬ìš©í•  ë¶€ë¶„ê³¼ ëª¨ë¸ì„ í‰ê°€í•˜ëŠ”ë° ì‚¬ìš©í•  ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

### ì‚¬ì „ ì§€ì‹ì„ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ë¥¼ êµ¬ì„±í•´ë³´ì!

ë¨¼ì € ìƒì„  ë°ì´í„°ë¥¼ ì¤€ë¹„í•œë‹¤.

```python
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0,
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0,
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8,
                10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0,
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7,
                7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]
```

ê·¸ í›„, numpy ë‚´ì¥ í•¨ìˆ˜ì¸ **column\_stack() í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì „ë‹¬ ë°›ì€ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¼ë ¬ë¡œ ì„¸ìš´ ë‹¤ìŒ ì°¨ë¡€ëŒ€ë¡œ ë‚˜ë€íˆ ì—°ê²°**í•œë‹¤.

```python
fish_data = np.column_stack((fish_length, fish_weight))

print(fish_data[:5])

// ê²°ê³¼ 
[[ 25.4 242. ]
 [ 26.3 290. ]
 [ 26.5 340. ]
 [ 29.  363. ]
 [ 29.  430. ]] // ì•ì—ì„œ ë¶€í„° ì‹œì‘í•˜ëŠ” 5ê°œì˜ ë°ì´í„°ë“¤ì˜ ìƒì„  ê¸¸ì´ì™€ ë¬´ê²Œê°€ ì•Œë§ê²Œ ì—°ê²°ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ 
```

ê·¸ ë‹¤ìŒìœ¼ë¡ , **concatenate í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ íƒ€ê²Ÿ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.**

```python
fish_target = np.concatenate((np.ones(35), np.zeros(14)))

print(fish_target)

// ê²°ê³¼ 
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0.] // íƒ€ê²Ÿ ë°ì´í„° ë˜í•œ ì˜ ë§Œë“¤ì–´ì§„ ëª¨ìŠµ 
```

### ì‚¬ì´í‚·ëŸ°ìœ¼ë¡œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ë‚˜ëˆ„ì!

2ì£¼ì°¨ì—ì„œëŠ” ë„˜íŒŒì´ ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ì§ì ‘ ì„ì–´ì„œ í›ˆë ¨ ì„¸íŠ¸ì™€ ë°ì´í„° ì„¸íŠ¸ë¥¼ ë‚˜ëˆ„ì—ˆë‹¤. ì´ ë°©ë²•ì€ ë²ˆê±°ë¡œìš´ ë°©ë²•ì´ê¸° ë•Œë¬¸ì— ì´ë²ˆ 3ì£¼ì°¨ì—ì„œëŠ” **ì‚¬ì´í‚·ëŸ°ì˜ ìœ í‹¸ë¦¬í‹° ë„êµ¬ì¸ train\_test\_split()í•¨ìˆ˜ë¥¼ ì´ìš©**í•  ê²ƒì´ë‹¤.

```python
# ìƒ˜í”Œë§ í¸í–¥ í˜„ìƒ
from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split (
    fish_data, fish_target, random_state=42 )
# ì´ ì±…ê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ìœ„í•´ seed 42 ê³ ì • 

print(train_input.shape, test_input.shape)
print(train_target.shape, test_target.shape)

print(test_target)

# ê²°ê³¼ 
(36, 2) (13, 2)
(36,) (13,)
[1. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]

// 13ê°œì˜ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì¤‘ 10ê°œê°€ ë„ë¯¸(1)ì´ê³ , 3ê°œê°€ ë¹™ì–´(0)ì´ë‹¤. ì˜ ì„ì¸ ê²ƒ ê°™ì§€ë§Œ ë¹™ì–´ì˜ ë¹„ìš¸ì´
ëª¨ìë¥´ë‹¤. ì›ë˜ ë„ë¯¸ì™€ ë¹™ì–´ì˜ ê°œìˆ˜ëŠ” 35ê°œì™€ 14ê°œë¡œ 2.5:1ë¹„ìœ¨ ì´ì˜€ì§€ë§Œ ì´ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ë¹™ì–´ì˜ ë¹„ìœ¨ì€
3.3:1ì´ë‹¤. 
```

ìƒ˜í”Œë§ í¸í–¥ í˜„ìƒì„ ë°”ë¡œ ì¡ê¸° ìœ„í•´ **stratify ë§¤ê°œë³€ìˆ˜ì— íƒ€ê¹ƒ ë°ì´í„°ë¥¼ ì „ë‹¬**í•œë‹¤.

```python
# ìƒ˜í”Œë§ í¸í–¥í˜„ìƒ ì¡°ì •
train_input, test_input, train_target, test_target = train_test_split (
    fish_data, fish_target, stratify=fish_target, random_state=42 )

print(test_target)

# ê²°ê³¼ 
[0. 0. 1. 0. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
ë¹™ì–´ ë°ì´í„°(0)ê°€ í•˜ë‚˜ ë” ëŠ˜ì–´ë‚œ ëª¨ìŠµ
```

### ìˆ˜ìƒí•œ ë„ë¯¸ì— ëŒ€í•´ ë¶„ì„í•´ë³´ì

ì•ì—ì„œ ì¤€ë¹„í•œ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ **k-ìµœê·¼ì ‘ ì´ì›ƒì„ í›ˆë ¨**í•´ë³´ì

```python
from sklearn.neighbors import KNeighborsClassifier

kn = KNeighborsClassifier()
kn.fit(train_input, train_target)
kn.score(test_input, test_target)

# ê²°ê³¼
1.0
// í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ë„ë¯¸ì™€ ë¹™ì–´ë¥¼ ëª¨ë‘ ì˜¬ë°”ë¥´ê²Œ ë¶„ë¥˜ í–ˆìŠµë‹ˆë‹¤.
```

ê·¸ë ‡ë‹¤ë©´ ì´ë²ˆ ì¥ì˜ ë¬¸ì œì˜€ë˜ ê¸¸ì´ 25, ë¬´ê²Œ 150gë‚˜ê°€ëŠ” ìƒì„ ì„ ì˜ˆì¸¡í•´ë³´ì.

```python
print(kn.predict([[25,150]]))

# ê²°ê³¼ 
[0.] ë¹™ì–´ë¼ê³  ì˜ˆì¸¡
```

ì–´ë–»ê²Œ ëœ ê²ƒì¼ê¹Œìš”? ì‚°ì ë„ë¥¼ ê·¸ë ¤ ë³´ì.

```python
import matplotlib.pyplot as plt

plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(25, 150, marker="^")
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-1.png" alt=""><figcaption></figcaption></figure>

ì‚°ì ë„ë¡œ ë³´ì•˜ì„ ë• ë‹¤ë¥¸ ë„ë¯¸ ë°ì´í„°ì™€ ë” ê°€ê¹ë‹¤. ì™œ ì´ ëª¨ë¸ì€ ì™¼ìª½ ì•„ë˜ ë‚®ê²Œ ê¹”ë¦° ë¹™ì–´ ë°ì´í„°ì— ê°€ê¹ë‹¤ê³  íŒë‹¨í•œ ê±¸ê¹Œ? kneighbor() ë©”ì„œë“œë¥¼ í™œìš©í•˜ì—¬ ê·¼ì ‘ ë°ì´í„°ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ì

```python
distance, indexes = kn.kneighbors([[25,150]])

print(distance)
print(indexes)
# ê²°ê³¼
[[ 92.00086956 130.48375378 130.73859415 138.32150953 138.39320793]]
[[21 33 19 30  1]]
print(train_input[indexes])

# ê²°ê³¼
[[[ 25.4 242. ]
  [ 15.   19.9]
  [ 14.3  19.7]
  [ 13.   12.2]
  [ 12.2  12.2]]]
import matplotlib.pyplot as plt

plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(25, 150, marker="^")
plt.scatter(train_input[indexes,0], train_input[indexes,1], color="r", marker="D")
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-2.png" alt=""><figcaption></figcaption></figure>

ê¸¸ì´ê°€ 25cm, ë¬´ê²Œê°€ 150gì¸ ìƒì„ ì— ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒì—ëŠ” ë¹™ì–´ê°€ ì••ë„ì ìœ¼ë¡œ ë§ë‹¤. ë”°ë¼ì„œ ì´ ìƒ˜í”Œì˜ í´ë˜ìŠ¤ë¥¼ ë¹™ì–´ë¡œ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì€ ë¬´ë¦¬ê°€ ì•„ë‹ˆë‹¤. ì™œ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒì„ ë¹™ì–´ë¼ê³  ìƒê°í• ê¹Œ?

ì´ ë¬¸ì œì˜ ì‹¤ë§ˆë¦¬ë¥¼ ì°¾ê¸° ìœ„í•´ kneighbors() ë©”ì„œë“œì—ì„œ ë°˜í™˜í•œ distances ë°°ì—´ì„ ì¶œë ¥í•´ë³´ì.

```
distance, indexes = kn.kneighbors([[25,150]])

print(distance)
print(indexes)

# ê²°ê³¼ 
[[ 92.00086956 130.48375378 130.73859415 138.32150953 138.39320793]]
[[21 33 19 30  1]]
```

ì‚°ì ë„ë¥¼ ë‹¤ì‹œ ì²œì²œíˆ ì‚´í´ë³´ë©´ ì‚¼ê°í˜• ìƒ˜í”Œì— ê°€ì¥ ê°€ê¹Œìš´ ì²« ë²ˆì§¸ ìƒ˜í”Œê¹Œì§€ì˜ ê±°ë¦¬ëŠ” 92ì´ê³ , ê·¸ ì™¸ ê°€ì¥ ê°€ê¹Œìš´ ìƒ˜í”Œë“¤ì€ ëª¨ë‘ 130, 138ì´ë‹¤. ê·¸ëŸ°ë° **ê±°ë¦¬ê°€ 92ì™€ 130ì´ë¼ê³  í–ˆì„ ë•Œ ê·¸ë˜í”„ì— ë‚˜íƒ€ë‚œ ê±°ë¦¬ ë¹„ìœ¨**ì´ ì´ìƒí•˜ë‹¤.

ì–´ë¦¼ì¡ì•„ë„ 92ì˜ ê±°ë¦¬ë³´ë‹¤ 130ì´ ëª‡ ë°°ëŠ” ë˜ì–´ ë³´ì´ëŠ”ë° ê±°ë¦¬ì˜ ë¹„ìœ¨ì´ ë„ˆë¬´ ì¢ë‹¤.

**xì¶• ë²”ìœ„ê°€ ì¢ê³ , yì¶• ë²”ìœ„ê°€ ë„“ì–´ì„œ ì¼ì–´ë‚œ ë¬¸ì œì˜€ë‹¤. ë”°ë¼ì„œ yì¶•ì´ ì¡°ê¸ˆë§Œ ë©€ì–´ë„ ê±°ë¦¬ê°€ ì•„ì£¼ í° ê°’ìœ¼ë¡œ ê³„ì‚°**ëœë‹¤.

ì´ë²ˆì—ëŠ” ëˆˆìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ xì¶•ì˜ ë²”ìœ„ë¥¼ ë™ì¼í•˜ê²Œ 0\~1000ìœ¼ë¡œ ë§ì¶”ì–´ë³´ì.

```
plt.scatter(train_input[:,0],train_input[:,1])
plt.scatter(25, 150, marker='^')
plt.scatter(train_input[indexes,0],train_input[indexes,1],color='r', marker='D')
plt.xlim(0,1000)
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-3.png" alt=""><figcaption></figcaption></figure>

### ê¸°ì¤€ì„ ë§ì¶°ë¼!

ë°ì´í„°ë¥¼ í‘œí˜„í•˜ëŠ” ê¸°ì¤€ì´ ë‹¤ë¥´ë©´ ì•Œê³ ë¦¬ì¦˜ì´ ì˜¬ë°”ë¥´ê²Œ ì˜ˆì¸¡í•  ìˆ˜ ì—†ë‹¤. ì•Œê³ ë¦¬ì¦˜ì´ ê±°ë¦¬ ê¸°ë°˜ì¼ ë•Œ íŠ¹íˆ ë” ê·¸ëŸ°ë°, ì—¬ê¸°ì—ëŠ” k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ë„ í¬í•¨ëœë‹¤. ì´ëŸ° ì•Œê³ ë¦¬ì¦˜ë“¤ì€ ìƒ˜í”Œ ê°„ì˜ ê±°ë¦¬ì— íŠ¹íˆ ì˜í–¥ì„ ë” ë§ì´ ë°›ê²Œ ë˜ëŠ”ë° ì´ëŸ° ê²½ìš° **ë°ì´í„° ì „ì²˜ë¦¬**ë¥¼ í•´ì£¼ì–´ì•¼ í•œë‹¤.

**í‘œì¤€ ì ìˆ˜**

* ê°€ì¥ ë„ë¦¬ ì‚¬ìš©í•˜ëŠ” ì „ì²˜ë¦¬ ë°©ë²• ì¤‘ í•˜ë‚˜
* zì ìˆ˜ ë¼ê³ ë„ í•œë‹¤.
* ê° íŠ¹ì„± ê°’ì´ í‰ê· ì—ì„œ í‘œì¤€í¸ì°¨ì˜ ëª‡ ë°°ë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ ë‚˜íƒ€ë‚¸ë‹¤.
* ê³„ì‚°ë°©ë²• â†’ í‰ê· ì„ ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆˆë‹¤.
* np.mean()í•¨ìˆ˜ì™€ np.std()í•¨ìˆ˜ ì´ìš©

ë¨¼ì €, í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ê·¸ë¦¬ê³  í‘œì¤€ ì ìˆ˜ë¥¼ ê³„ì‚°í•´ë³´ì.

```
mean = np.mean(train_input, axis=0)
std = np.std(train_input, axis=0)

print(mean, std)
# ê²°ê³¼
[ 27.29722222 454.09722222] [  9.98244253 323.29893931]
train_scaled = (train_input - mean)/std

print(train_scaled[:5])
```

ë¬´ì–¸ê°€ ì´ìƒí•˜ë‹¤. ì˜¤ë¥¸ìª½ ë§¨ ê¼­ëŒ€ê¸°ì— ìˆ˜ìƒí•œ ìƒ˜í”Œ í•˜ë‚˜ë§Œ ë©ê·¸ëŸ¬ë‹ˆ ë–¨ì–´ì ¸ ìˆë‹¤. **ì´ëŸ¬í•œ ì´ìœ ëŠ” \[25,150] ë°ì´í„° ë˜í•œ ë™ì¼ ë¹„ìœ¨ë¡œ ë°”ê¾¸ì–´ ì£¼ì–´ì•¼ í•œë‹¤.**

```
plt.scatter(train_scaled[:,0],train_scaled[:,1])
plt.scatter(25, 150, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-4.png" alt=""><figcaption></figcaption></figure>

ì´ ê·¸ë˜í”„ëŠ” í‘œì¤€í¸ì°¨ë¡œ ë³€í™˜í•˜ê¸° ì „ ì‚°ì ë„ì™€ ê±°ì˜ ë™ì¼í•˜ë‹¤. ë‹¬ë¼ì§„ ì ì€ xì¶•ê³¼ yì¶•ì˜ ë²”ìœ„ê°€ -1.5 \~ 1.5ë¡œ ë°”ë€Œì—ˆë‹¤ëŠ” ê²ƒì´ë‹¤.

```
new = ([25,150]-mean)/std

plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(new[0], new[1], marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-5.png" alt=""><figcaption></figcaption></figure>

```
kn.fit(train_scaled, train_target)

test_scaled = (test_input - mean) / std

print(test_scaled)

kn.score(test_scaled, test_target)

# ê²°ê³¼
[[ 0.57047806 -0.24275448]
 [-1.34907044 -1.25805401]
 [-1.16299176 -1.23846923]
 [-1.36865767 -1.26178444]
 [ 0.66841421  0.87637544]
 [ 0.96222266  0.91989716]
 [ 0.86428651  0.93854933]
 [ 0.86428651  0.9540928 ]
 [ 1.20706303  1.66909247]
 [ 0.71738229  0.72094073]
 [ 0.52150999  0.2546366 ]
 [ 0.27666962  0.037028  ]
 [ 1.4519034   1.65354899]]
1.0
```

ì´ì œ **ì•ì—ì„œ ì‹¤íŒ¨í•œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë„£ì–´ ì˜ˆì¸¡**í•´ë³´ì.

```python
print(kn.predict([new]))

# ê²°ê³¼
[1.]
```

ë§ˆì§€ë§‰ìœ¼ë¡œ ì‚°ì ë„ë¥¼ ê·¸ë ¤ë³´ì.

```python
distance, indexes = kn.kneighbors([new])

plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(new[0], new[1], marker='^')
plt.scatter(train_scaled[indexes,0], train_scaled[indexes,1], marker='D')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-6.png" alt=""><figcaption></figcaption></figure>

```python
train_target[indexes]

# ê²°ê³¼
array([[1., 1., 1., 1., 1.]])
```

ìƒ˜í”Œ ë°ì´í„° ì£¼ë³€ 5 ë°ì´í„° ì¤‘ 5ê°€ ë„ë¯¸ ë°ì´í„°ì´ë‹¤. ì „ì²˜ë¦¬ë¥¼ í†µí•´ ë°ì´í„° í•™ìŠµ ëª¨ë¸ì˜ ì •í™•ë„ í–¥ìƒ

## 3ì£¼ì°¨ 2ë²ˆì§¸ ìˆ˜ì—…

ğŸ¤¨ **ë¬¸ì œì— ëŒ€í•œ ì„¤ëª…**

ë†ì–´ì˜ ë¬´ê²Œ(íƒ€í‚·)ë¥¼ ì˜ˆì¸¡í•´ë¼!

ğŸ˜„ **ì‚¬ì „ì— ì•Œê³  ê°€ì•¼ í•  ì§€ì‹**

* ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì€ í¬ê²Œ **ë¶„ë¥˜ì™€ íšŒê·€**ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ë¶„ë¥˜ëŠ” ë§ ê·¸ëŒ€ë¡œ ìƒ˜í”Œì„ ëª‡ ê°œì˜ í´ë˜ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤. **íšŒê·€ëŠ” í´ë˜ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì„ì˜ì˜ ì–´ë–¤ ìˆ«ìë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œ**ì…ë‹ˆë‹¤.
* ë˜í•œ 2ì£¼ì°¨ì—ë„ ì‚¬ìš©í–ˆë˜ k-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ì´ íšŒê·€ì—ë„ ì‘ë™í•œë‹¤.

### ì‚¬ì „ ì§€ì‹ì„ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ë¥¼ êµ¬ì„±í•´ë³´ì!

```python
import numpy as np

perch_length = np.array([8.4, 13.7, 15.0, 16.2, 17.4, 18.0, 18.7, 19.0, 19.6, 20.0, 21.0,
       21.0, 21.0, 21.3, 22.0, 22.0, 22.0, 22.0, 22.0, 22.5, 22.5, 22.7,
       23.0, 23.5, 24.0, 24.0, 24.6, 25.0, 25.6, 26.5, 27.3, 27.5, 27.5,
       27.5, 28.0, 28.7, 30.0, 32.8, 34.5, 35.0, 36.5, 36.0, 37.0, 37.0,
       39.0, 39.0, 39.0, 40.0, 40.0, 40.0, 40.0, 42.0, 43.0, 43.0, 43.5,
       44.0])
perch_weight = np.array([5.9, 32.0, 40.0, 51.5, 70.0, 100.0, 78.0, 80.0, 85.0, 85.0, 110.0,
       115.0, 125.0, 130.0, 120.0, 120.0, 130.0, 135.0, 110.0, 130.0,
       150.0, 145.0, 150.0, 170.0, 225.0, 145.0, 188.0, 180.0, 197.0,
       218.0, 300.0, 260.0, 265.0, 250.0, 250.0, 300.0, 320.0, 514.0,
       556.0, 840.0, 685.0, 700.0, 700.0, 690.0, 900.0, 650.0, 820.0,
       850.0, 900.0, 1015.0, 820.0, 1100.0, 1000.0, 1100.0, 1000.0,
       1000.0])
print(perch_length.shape, perch_weight.shape)
```

ì´ ë°ì´í„°ê°€ ì–´ë–¤ í˜•íƒœë¥¼ ë ê³  ìˆëŠ”ì§€ ì‚°ì ë„ë¥¼ ê·¸ë ¤ë³´ì

```python
import matplotlib.pyplot as plt

plt. scatter(perch_length, perch_weight)
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```

<figure><img src="../../.gitbook/assets/3-7.png" alt=""><figcaption></figcaption></figure>

ê·¸ í›„ ì‚¬ì´í‚·ëŸ°ì˜ train\_test\_split() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆˆë‹¤. ì—¬ê¸°ì„œ **ì‚¬ì´í‚·ëŸ°ì˜ í›ˆë ¨ì„¸íŠ¸ëŠ” 2ì°¨ì› ë°°ì—´ì´ì–´ì•¼ í•˜ë¯€ë¡œ 1ì°¨ì› ë°°ì—´ì„ 1ê°œì˜ ì—´ì´ ìˆëŠ” 2ì°¨ì› ë°°ì—´ë¡œ ë°”ê¾¸ì–´ì•¼ í•œë‹¤.**

```python
from sklearn.model_selection import train_test_split

train_input, test_input, train_target, test_target = train_test_split(
    perch_length, perch_weight, random_state=42)

print(train_input.shape, test_input.shape)
print(train_target.shape, test_target.shape)

# ê²°ê³¼
(42,) (14,)
(42,) (14,)
```

ì—¬ê¸°ì„œëŠ” **reshapeë¼ëŠ” ë©”ì„œë“œ**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì—´ì˜ í¬ê¸°ë¥¼ ì§€ì •í•œë‹¤.

```python
train_input = train_input.reshape(train_input.size, 1)
print(train_input.shape)
test_input = test_input.reshape(-1,1)
print(test_input.shape)

# ê²°ê³¼ 
(42, 1)
(14, 1)
```

### ê²°ì •ê³„ìˆ˜(R^2)ë€?

ì‚¬ì´í‚·ëŸ°ì—ì„œ k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” **KNeighborsRegressor**ë‹¤. ì´ í´ë˜ìŠ¤ì˜ ì‚¬ìš©ë²•ì€ KNeighborsClassifierì™€ ë§¤ìš° ë¹„ìŠ·í•˜ë‹¤.

```python
from sklearn.neighbors import KNeighborsRegressor

knr = KNeighborsRegressor()

knr.fit(train_input, train_target)
knr.score(test_input, test_target)

# ê²°ê³¼
0.992809406101064
```

ê·¸ëŸ°ë° scoreë¡œ ë‚˜ì˜¨ ì´ ì ìˆ˜ëŠ” ë¬´ì—‡ì¼ê¹Œ? ë¶„ë¥˜ì˜ ê²½ìš°ëŠ” í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ìˆëŠ” ìƒ˜í”Œì„ ì •í™•í•˜ê²Œ ë¶„ë¥˜í•œ ê°œìˆ˜ì˜ ë¹„ìœ¨ì„ scoreë¡œ ë‚˜íƒ€ë‚´ì—ˆë‹¤. íšŒê·€ì—ì„œëŠ” ì˜ˆì¸¡ ê°’ì´ë‚˜ íƒ€ê¹ƒ ëª¨ë‘ ì„ì˜ì˜ ìˆ˜ì¹˜ì´ê¸° ë•Œë¬¸ì— ì •í™•í•œ ìˆ«ìë¥¼ ë§ì¶˜ë‹¤ëŠ”ê²ƒì€ ê±°ì˜ ë¶ˆê°€ëŠ¥ì— ê°€ê¹ë‹¤. ê·¸ë˜ì„œ íšŒê·€ì— ê²½ìš° ì¡°ê¸ˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ í‰ê°€í•˜ëŠ”ë° ì´ ì ìˆ˜ë¥¼ \*\*ê²°ì •ê³„ìˆ˜(R^2)\*\*ë¼ê³  í•œë‹¤.

<figure><img src="../../.gitbook/assets/3-8.png" alt=""><figcaption></figcaption></figure>

ê²°ì • ê³„ìˆ˜ì˜ ê°’ì€ í•´ë‹¹ ê³µì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ”ë°, ë§Œì•½ **íƒ€ê²Ÿì˜ í‰ê·  ì •ë„ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ìˆ˜ì¤€ì´ë¼ë©´ (ì¦‰ ë¶„ìì™€ ë¶„ëª¨ê°€ ë¹„ìŠ·í•´ì ¸) R^2ëŠ” 0ì— ê°€ê¹Œì›Œ ì§€ê³ , ì˜ˆì¸¡ì´ íƒ€ê²Ÿì— ì•„ì£¼ ê°€ê¹Œì›Œì§€ë©´ (ë¶„ìê°€ 0ì— ê°€ê¹Œì›Œì§€ê¸° ë–„ë¬¸ì—) 1ì— ê°€ê¹Œìš´ ê°’ì´ ëœë‹¤.** ì‚¬ì´í‚·ëŸ°ì—ì„œ score() ë©”ì†Œë“œì˜ ê°’ì€ ë†’ì„ìˆ˜ë¡ ì¢‹ìœ¼ë¯€ë¡œ 0.99ì´ë©´ ì•„ì£¼ ì¢‹ì€ ê²°ê³¼ ê°’ì´ë‹¤. í•˜ì§€ë§Œ ì •í™•ë„ì²˜ëŸ¼ R^2ê°€ ì§ê°ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ì´í•´í•˜ê¸°ëŠ” ì–´ë µë‹¤.

ê·¸ë˜ì„œ ì´ ì±…ì—ì„œëŠ” **íƒ€ê²Ÿê³¼ ì˜ˆì¸¡í•œ ê°’ ì‚¬ì´ì˜ ì°¨ì´ë¥¼ êµ¬í•´ ì˜ˆì¸¡ì´ ì–´ëŠ ì •ë„ ë²—ì–´ë‚¬ëŠ”ì§€ ê°€ëŠ **í•´ ë³¸ë‹¤. ì¶”ê°€ì ìœ¼ë¡œ **íƒ€ê²Ÿê³¼ ì˜ˆì¸¡ì˜ ì ˆëŒ“ê°’ ì˜¤ì°¨ë¥¼ í‰ê· í•˜ì—¬ ë°˜í™˜í•˜ëŠ” mean\_absolute\_error**ë¥¼ ì‚¬ìš©í•œë‹¤.

```python
from sklearn.metrics import mean_absolute_error

test_prediction = knr.predict(test_input)

mae = mean_absolute_error(test_target, test_prediction)
print(mae)

# ê²°ê³¼
19.157142857142862
# ê²°ê³¼ ì˜ˆì¸¡ì—ì„œ í‰ê· ì ìœ¼ë¡œ 19g ì •ë„ íƒ€ê²Ÿ ê°’ê³¼ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. 
```

ì§€ê¸ˆê¹Œì§€ëŠ” í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•´ ëª¨ë¸ì„ í›ˆë ¨í•˜ê³  í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ëª¨ë¸ì„ í‰ê°€í–ˆë‹¤. ê·¸ëŸ°ë° í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•´ í‰ê°€ í•´ë³´ë©´ ì–´ë–¨ê¹Œ?

### **ê³¼ëŒ€ì í•© vs ê³¼ì†Œì í•©**

```python
print(knr.score(train_input, train_target))

# í›ˆë ¨ ë°ì´í„° ê²°ê³¼
0.9698823289099254
print(knr.score(test_input, test_target))

# í…ŒìŠ¤íŠ¸ ë°ì´í„° ê²°ê³¼
0.992809406101064
```

ë¬´ì–¸ê°€ ì´ìƒí•˜ì§€ ì•Šì€ê°€? ëª¨ë¸ì„ í›ˆë ¨ ì„¸íŠ¸ì— í›ˆë ¨í•˜ë©´ í›ˆë ¨ ì„¸íŠ¸ì— ì•Œë§ëŠ” ëª¨ë¸ì´ ë§Œë“¤ì–´ì§„ë‹¤. **ì¼ë°˜ì ìœ¼ë¡œ í›ˆë ¨ì„¸íŠ¸ë¡œ ëª¨ë¸ì„ í›ˆë ¨ ì‹œì¼œ ë§Œë“¤ì–´ì§„ ê²ƒì´ í•´ë‹¹ ëª¨ë¸ì´ë¼ë©´ í›ˆë ¨ ì„¸íŠ¸ê°€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë³´ë‹¤ ë” ì¢‹ì€ ì ìˆ˜ë¥¼ ë°›ì•„ì•¼ ì •ìƒì´ì§€ ì•Šì„ê¹Œ?**

ë§Œì•½ **í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ì ìˆ˜ê°€ êµ‰ì¥ì´ ì¢‹ì•˜ëŠ”ë° í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œëŠ” ì ìˆ˜ê°€ êµ‰ì¥íˆ ë‚˜ì˜ë‹¤ë©´ ëª¨ë¸ì´ í›ˆë ¨ ì„¸íŠ¸ì— ê³¼ëŒ€ ì í•©** ë˜ì—ˆë‹¤ê³  ë§í•œë‹¤. ì¦‰ ì´ ëª¨ë¸ì€ í›ˆë ¨ ì„¸íŠ¸ì—ë§Œ ì˜ ë™ì‘í•  ë¿ ì‹¤ì „ì—ì„œ ì˜ ë™ì‘í•˜ì§€ ì•ŠëŠ” ëª¨ë¸ì´ë‹¤.

ë°˜ëŒ€ë¡œ **í›ˆë ¨ ì„¸íŠ¸ë³´ë‹¤ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ë†’ê±°ë‚˜ ë‘ ì ìˆ˜ ëª¨ë‘ ë„ˆë¬´ ë‚®ì€ ê²½ìš°ëŠ” ëª¨ë¸ì´ ê³¼ì†Œ ì í•©** ë˜ì—ˆë‹¤ê³  í•œë‹¤. ì¦‰, ëª¨ë¸ì´ ë„ˆë¬´ ë‹¨ìˆœí•˜ì—¬ í›ˆë ¨ ì„¸íŠ¸ì— ì ì ˆíˆ í›ˆë ¨ë˜ì§€ ì•Šì€ ê²½ìš°ì´ë‹¤. í›ˆë ¨ ì„¸íŠ¸ê°€ ì „ì²´ ë°ì´í„°ë¥¼ ëŒ€í‘œí•œë‹¤ê³  ê°€ì •í•˜ê¸° ë•Œë¬¸ì— í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì˜ í•™ìŠµí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

ìœ„ì—ì„œ ë‚˜íƒ€ë‚œ ë¬¸ì œëŠ” **ê³¼ì†Œ ì í•©**

### **ì–´ë–»ê²Œ í•˜ë©´ ê³¼ì†Œì í•© ë¬¸ì œê°€ í•´ê²°ë ê¹Œ?**

* ëª¨ë¸ì„ ì¡°ê¸ˆ ë” ë³µì¡í•˜ê²Œ ë§Œë“¤ì–´ì„œ í•´ê²°í•˜ë©´ ëœë‹¤.
* k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜: ì´ì›ƒ ê°œìˆ˜ë¥¼ ì¤„ì´ë©´ êµ­ì§€ì  íŒ¨í„´ì— ë¯¼ê°í•´ì ¸ì„œ ë³µì¡í•œ ëª¨ë¸ì´ ëœë‹¤.

```python
# ì´ì›ƒì˜ ê°œìˆ˜ë¥¼ 3ìœ¼ë¡œ ì„¤ì •
knr.n_neighbors = 3

knr.fit(train_input, train_target)
print(knr.score(train_input, train_target))
print(knr.score(test_input, test_target))

# ê²°ê³¼ 
0.9804899950518966
0.9746459963987609
```

**ë‹¤ìŒì€ n\_neighbors ê°’ ë³€ê²½ì— ë”°ë¥¸ ëª¨ë¸ íŠœë‹ ì˜ˆì œì´ë‹¤.**

```python
knr = KNeighborsRegressor()

x = np.arange(5,45).reshape(-1,1)

for n in (1, 3, 5, 10, 30, 40) :
  knr.n_neighbors = n
  knr.fit(train_input, train_target)

  prediction = knr.predict(x)

  plt.scatter(train_input, train_target)
  plt.plot(x, prediction)
  plt.title('n_neighbors = {}'.format(n))
  plt.xlabel('length')
  plt.ylabel('weight')
  plt.show()

  print(knr.score(train_input, train_target))
  print(knr.score(test_input, test_target))
```

<div>

<figure><img src="../../.gitbook/assets/3-9 (1).png" alt=""><figcaption></figcaption></figure>

 

<figure><img src="../../.gitbook/assets/3-10 (1).png" alt=""><figcaption></figcaption></figure>

 

<figure><img src="../../.gitbook/assets/3-11 (1).png" alt=""><figcaption></figcaption></figure>

 

<figure><img src="../../.gitbook/assets/3-12 (1).png" alt=""><figcaption></figcaption></figure>

 

<figure><img src="../../.gitbook/assets/3-13 (1).png" alt=""><figcaption></figcaption></figure>

 

<figure><img src="../../.gitbook/assets/3-14 (1).png" alt=""><figcaption></figcaption></figure>

</div>
